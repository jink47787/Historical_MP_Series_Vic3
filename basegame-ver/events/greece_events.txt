namespace = greece

# je_greek_nationalism start event
greece.1 = {
	type = country_event

	title = greece.1.t
	desc = greece.1.d
	flavor = greece.1.f

	event_image = {
		video = "unspecific_signed_contract"
	}

	icon = "gfx/interface/icons/event_icons/waving_flag.dds"

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"

	duration = 3

	trigger = {
		# Triggered by JE
	}

	immediate = {
		random_primary_culture = {
			save_scope_as = greek_culture_scope
		}
	}

	option = {
		name = greece.1.a
		default_option = yes
		if = {
			limit = {
				NOR = {
					has_claim = s:STATE_MACEDONIA
					owns_entire_state_region = STATE_MACEDONIA
				}
			}
			s:STATE_MACEDONIA = {
				add_claim = ROOT
			}
		}
		if = {
			limit = {
				NOR = {
					owns_entire_state_region = STATE_WESTERN_THRACE
					has_claim = s:STATE_WESTERN_THRACE
				}
			}
			s:STATE_WESTERN_THRACE = {
				add_claim = ROOT
			}
		}
		if = {
			limit = {
				NOR = {
					owns_entire_state_region = STATE_EAST_AEGEAN_ISLANDS
					has_claim = s:STATE_EAST_AEGEAN_ISLANDS
				}
			}
			s:STATE_EAST_AEGEAN_ISLANDS = {
				add_claim = ROOT
			}
		}
		if = {
			limit = {
				NOR = {
					owns_entire_state_region = STATE_CRETE
					has_claim = s:STATE_CRETE
				}
			}
			s:STATE_CRETE = {
				add_claim = ROOT
			}
		}
		if = {
			limit = {
				exists = c:TUR
				c:TUR ?= {
					OR = {
						owns_entire_state_region = STATE_MACEDONIA
						owns_entire_state_region = STATE_WESTERN_THRACE
						owns_entire_state_region = STATE_EAST_AEGEAN_ISLANDS
						owns_entire_state_region = STATE_CRETE
					}
				}
			}
			change_relations = {
				country = c:TUR
				value = -10
			}
		}
		if = {
			limit = {
				exists = c:RUS
				any_scope_state = {
					region = sr:region_balkans
					has_claim_by = c:RUS
				}
			}
			change_relations = {
				country = c:RUS
				value = 10
			}
		}
		change_infamy = 10
		custom_tooltip = {
			text = embrace_megali_idea_tt
			set_variable = embrace_megali_idea_var # triggers a trigger_if in je_greek_nationalism `complete`
		}
	}
	option = {
		name = greece.1.b
		if = {
			limit = {
				exists = c:TUR
				c:TUR ?= {
					OR = {
						owns_entire_state_region = STATE_MACEDONIA
						owns_entire_state_region = STATE_WESTERN_THRACE
						owns_entire_state_region = STATE_EAST_AEGEAN_ISLANDS
						owns_entire_state_region = STATE_CRETE
					}
				}
			}
			change_relations = {
				country = c:TUR
				value = 30
			}
		}
		if = {
			limit = {
				exists = c:RUS
				any_scope_state = {
					region = sr:region_balkans
					has_claim_by = c:RUS
				}
			}
			change_relations = {
				country = c:RUS
				value = -10
			}
		}
		custom_tooltip = {
			text = not_embrace_megali_idea_tt
			set_variable = no_megali_idea_var # triggers a trigger_if in je_greek_nationalism `complete`
		}
	}
}

# For Taking the The Great Idea™ Too Far, a je_greek_nationalism c:BYZ event
greece.2 = {
	type = country_event

	title = greece.2.t
	desc = greece.2.d
	flavor = greece.2.f

	event_image = {
		video = "unspecific_signed_contract"
	}

	icon = "gfx/interface/icons/event_icons/waving_flag.dds"

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"

	duration = 3

	trigger = { # triggered by je_greek_nationalism
		NOT = { has_variable = byzantium_event_fired }
		has_variable = embrace_megali_idea_var
		any_scope_state = {
			state_region = s:STATE_IONIAN_ISLANDS
		}
		NOT = { has_game_rule = plausible_formable_nations }
		has_law_or_variant = law_type:law_monarchy
		government_legitimacy >= 75
	}

	cooldown = { days = never_fire_again_modifier_time }

	immediate = {
		if = {
			limit = {
				s:STATE_EASTERN_THRACE = {
					any_scope_state = {
						NOT = {
							owner = ROOT
						}
					}
				}
			}
			s:STATE_EASTERN_THRACE = {
				random_scope_state = {
					limit = {
						NOT = {
							owner = ROOT
						}
					}
					owner = {
						save_scope_as = thrace_owner
					}
				}
			}
		}
		s:STATE_EASTERN_THRACE = {
			random_scope_state = {
				save_scope_as = thrace_scope
			}
		}
		if = {
			limit = {
				s:STATE_AYDIN = {
					any_scope_state = {
						NOT = {
							owner = ROOT
						}
					}
				}
			}
			s:STATE_AYDIN = {
				random_scope_state = {
					limit = {
						NOT = {
							owner = ROOT
						}
					}
					owner = {
						save_scope_as = aydin_owner
					}
				}
			}
		}
		s:STATE_AYDIN = {
			random_scope_state = {
				save_scope_as = aydin_scope
			}
		}
		set_variable = byzantium_event_fired
	}

	option = {
		name = greece.2.a
		if = {
			limit = {
				exists = c:TUR
				c:TUR ?= {
					OR = {
						owns_entire_state_region = STATE_MACEDONIA
						owns_entire_state_region = STATE_WESTERN_THRACE
						owns_entire_state_region = STATE_EAST_AEGEAN_ISLANDS
						owns_entire_state_region = STATE_CRETE
					}
				}
			}
			change_relations = {
				country = c:TUR
				value = -20
			}
		}
		if = {
			limit = {
				NOT = { owns_entire_state_region = STATE_EASTERN_THRACE }
			}
			s:STATE_EASTERN_THRACE = {
				add_claim = ROOT
			}
		}
		if = {
			limit = {
				NOT = { owns_entire_state_region = STATE_AYDIN }
			}
			s:STATE_AYDIN = {
				add_claim = ROOT
			}
		}
		if = {
			limit = {
				AND = {
					exists = scope:thrace_owner
					scope:thrace_owner = {
						NOT = {
							c:TUR ?= this
						}
					}
				}
			}
			create_incident = {
				country = scope:thrace_owner
				value = -10
			}
		}
		if = {
			limit = {
				AND = {
					exists = scope:aydin_owner
					scope:aydin_owner = {
						NOT = {
							c:TUR ?= this
						}
					}
				}
			}
			create_incident = {
				country = scope:aydin_owner
				value = -10
			}
		}
		if = {
			limit = {
				exists = c:RUS
				any_scope_state = {
					region = sr:region_balkans
					has_claim_by = c:RUS
				}
			}
			change_relations = {
				country = c:RUS
				value = 10
			}
		}
		change_infamy = 20
		custom_tooltip = {
			text = embrace_ambitious_agenda_tt
			set_variable = embrace_ambitious_agenda_var # triggers a trigger_if in je_greek_nationalism `complete`
			remove_variable = embrace_megali_idea_var
		}
	}
	option = {
		name = greece.2.b
		default_option = yes
		if = {
			limit = {
				exists = c:RUS
				any_scope_state = {
					region = sr:region_balkans
					has_claim_by = c:RUS
				}
			}
			change_relations = {
				country = c:RUS
				value = -15
			}
		}
		if = {
			limit = {
				AND = {
					exists = scope:aydin_owner
					exists = scope:thrace_owner
					scope:aydin_owner = scope:thrace_owner
				}
			}
			change_relations = {
				country = scope:aydin_owner
				value = 30
			}
		}
		else_if = {
			limit = {
				exists = scope:thrace_owner
			}
			change_relations = {
				country = scope:thrace_owner
				value = 15
			}
		}
		else_if = {
			limit = {
				exists = scope:aydin_owner
			}
			change_relations = {
				country = scope:aydin_owner
				value = 15
			}
		}
		custom_tooltip = {
			text = not_embrace_ambitious_agenda_tt
		}
	}
}

# je_greek_nationalism Annex Ionian Islands event
greece.3 = {
	type = country_event

	title = greece.3.t
	desc = greece.3.d
	flavor = greece.3.f

	placement = scope:ionian_overlord_capital

	event_image = {
		video = "unspecific_signed_contract"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"

	duration = 3

	trigger = {
		# triggered by greece.6
	}

	immediate = {
		c:ION ?= {
			save_scope_as = ionian_country
			top_overlord = {
				save_scope_as = ionian_overlord
				capital = {
					save_scope_as = ionian_overlord_capital
				}
			}
		}
	}

	cancellation_trigger = {
		NOT = {
			exists = scope:ionian_overlord
		}
	}

	option = {
		name = greece.3.a
		default_option = yes
		annex = c:ION
	}
}

# je_greek_nationalism completion event
greece.4 = {
	type = country_event

	title = greece.4.t

	desc = {
		first_valid = {
			triggered_desc = {
				desc = greece.4.d1 # Loc if completed with pursuit of Title of Eastern Rome or if completed with pursuit of Megali Idea
				trigger = {
					OR = {
						has_variable = embrace_ambitious_agenda_var
						has_variable = embrace_megali_idea_var
					}
				}
			}
			triggered_desc = {
				desc = greece.4.d2
				trigger = {
					always = yes
				}
			}
		}
	}
	flavor = greece.4.f

	event_image = {
		video = "unspecific_ruler_speaking_to_people"
	}

	icon = "gfx/interface/icons/event_icons/waving_flag.dds"

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"

	duration = 3

	trigger = {
		# Triggered by JE
	}

	immediate = {
		random_primary_culture = {
			save_scope_as = greek_culture_scope
		}
	}

	option = {
		name = greece.4.a
		if = {
			limit = {
				has_variable = embrace_ambitious_agenda_var
			}
			add_modifier = {
				name = greek_nationalism_success_3
				days = very_long_modifier_time
				is_decaying = yes
			}
		}
		else_if = {
			limit = {
				has_variable = embrace_megali_idea_var
			}
			add_modifier = {
				name = greek_nationalism_success_2
				days = very_long_modifier_time
				is_decaying = yes
			}
		}
		else = {
			add_modifier = {
				name = greek_nationalism_success_1
				days = very_long_modifier_time
				is_decaying = yes
			}
		}
	}
	option = {
		name = greece.4.b
		default_option = yes
		if = {
			limit = {
				has_variable = embrace_ambitious_agenda_var
			}
			add_modifier = {
				name = greek_nationalism_3
				days = very_long_modifier_time
				is_decaying = yes
			}
			add_modifier = {
				name = greek_nationalism_clout_add_3
				days = very_long_modifier_time
				is_decaying = yes
			}
		}
		else_if = {
			limit = {
				has_variable = embrace_megali_idea_var
			}
			add_modifier = {
				name = greek_nationalism_2
				days = very_long_modifier_time
				is_decaying = yes
			}
			add_modifier = {
				name = greek_nationalism_clout_add_2
				days = very_long_modifier_time
				is_decaying = yes
			}
		}
		else = {
			add_modifier = {
				name = greek_nationalism_1
				days = very_long_modifier_time
				is_decaying = yes
			}
			add_modifier = {
				name = greek_nationalism_clout_add_1
				days = very_long_modifier_time
				is_decaying = yes
			}
		}
	}
	option = {
		name = greece.4.c
		trigger = {
			NOT = { has_variable = embrace_ambitious_agenda_var }
			OR = {
				NOT = { owns_entire_state_region = STATE_AYDIN }
				NOT = { owns_entire_state_region = STATE_EASTERN_THRACE }
				NOT = { owns_entire_state_region = STATE_HUDAVENDIGAR }
				NOT = { owns_entire_state_region = STATE_TRABZON }
			}
		}
		add_modifier = {
			name = greek_nationalism_clout_add_2
			days = very_long_modifier_time
			is_decaying = yes
		}
	}
}

# je_greek_nationalism fail event
greece.5 = {
	type = country_event

	title = greece.5.t
	desc = greece.5.d
	flavor = greece.5.f

	event_image = {
		video = "unspecific_politicians_arguing"
	}

	icon = "gfx/interface/icons/event_icons/waving_flag.dds"

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"

	duration = 3

	trigger = {
		# Triggered by JE
	}

	immediate = {
		ruler = { save_scope_as = ruler_scope }
		random_primary_culture = {
			save_scope_as = greek_culture_scope
		}
	}

	cancellation_trigger = {
		NOT = {
			exists = scope:ruler_scope
		}
	}

	option = {
		name = greece.5.a
		default_option = yes
		if = {
			limit = {
				has_variable = embrace_ambitious_agenda_var
			}
			add_modifier = {
				name = failed_je_greek_nationalism_3
				days = very_long_modifier_time
				is_decaying = yes
			}
			if = {
				limit = {
					NOT = { owns_entire_state_region = STATE_AYDIN }
				}
				s:STATE_AYDIN = {
					remove_homeland = cu:greek
					custom_tooltip = {
						text = move_greeks_tt
						every_scope_state = {
							every_scope_pop = {
								limit = {
									culture = cu:greek
								}
								move_pop = root.capital
							}
						}
					}
				}
			}
			if = {
				limit = {
					NOT = { owns_entire_state_region = STATE_EASTERN_THRACE }
				}
				s:STATE_EASTERN_THRACE = {
					remove_homeland = cu:greek
					custom_tooltip = {
						text = move_greeks_tt
						every_scope_state = {
							every_scope_pop = {
								limit = {
									culture = cu:greek
								}
								move_pop = root.capital
							}
						}
					}
				}
			}
			if = {
				limit = {
					NOT = { owns_entire_state_region = STATE_HUDAVENDIGAR }
				}
				s:STATE_HUDAVENDIGAR = {
					remove_homeland = cu:greek
					custom_tooltip = {
						text = move_greeks_tt
						every_scope_state = {
							every_scope_pop = {
								limit = {
									culture = cu:greek
								}
								move_pop = root.capital
							}
						}
					}
				}
			}
			if = {
				limit = {
					NOT = { owns_entire_state_region = STATE_TRABZON }
				}
				s:STATE_TRABZON = {
					remove_homeland = cu:greek
					custom_tooltip = {
						text = move_greeks_tt
						every_scope_state = {
							every_scope_pop = {
								limit = {
									culture = cu:greek
								}
								move_pop = root.capital
							}
						}
					}
				}
			}
		}
		else_if = {
			limit = {
				has_variable = embrace_megali_idea_var
			}
			add_modifier = {
				name = failed_je_greek_nationalism_2
				days = very_long_modifier_time
				is_decaying = yes
			}
		}
		else = {
			add_modifier = {
				name = failed_je_greek_nationalism_1
				days = very_long_modifier_time
				is_decaying = yes
			}
		}
		every_interest_group = {
			limit = {
				is_in_government = yes
			}
			add_modifier = {
				name = failed_greek_je_ig_attraction
				days = very_long_modifier_time
				is_decaying = yes
			}
		}
		if = {
			limit = {
				any_interest_group = {
					ig_counts_as_marginal = no
					is_in_government = no
				}
			}
			every_interest_group = {
				limit = {
					ig_counts_as_marginal = no
					is_in_government = no
				}
				add_modifier = {
					name = failed_greek_je_opposition_ig_pol_str
					days = very_long_modifier_time
					is_decaying = yes
				}
			}
		}
	}

	option = {
		name = greece.5.b
		if = {
			limit = {
				has_variable = embrace_ambitious_agenda_var
			}
			scope:ruler_scope = {
				add_modifier = {
					name = greek_ruler_negative_popularity_3
					days = very_long_modifier_time
					is_decaying = yes
				}
			}
			add_modifier = {
				name = greek_nationalism_failure_3
				days = very_long_modifier_time
				is_decaying = yes
			}
			if = {
				limit = {
					NOT = { owns_entire_state_region = STATE_AYDIN }
				}
				s:STATE_AYDIN = {
					remove_homeland = cu:greek
					custom_tooltip = {
						text = move_greeks_tt
						every_scope_state = {
							every_scope_pop = {
								limit = {
									culture = cu:greek
								}
								move_pop = root.capital
							}
						}
					}
				}
			}
			if = {
				limit = {
					NOT = { owns_entire_state_region = STATE_EASTERN_THRACE }
				}
				s:STATE_EASTERN_THRACE = {
					remove_homeland = cu:greek
					custom_tooltip = {
						text = move_greeks_tt
						every_scope_state = {
							every_scope_pop = {
								limit = {
									culture = cu:greek
								}
								move_pop = root.capital
							}
						}
					}
				}
			}
			if = {
				limit = {
					NOT = { owns_entire_state_region = STATE_HUDAVENDIGAR }
				}
				s:STATE_HUDAVENDIGAR = {
					remove_homeland = cu:greek
					custom_tooltip = {
						text = move_greeks_tt
						every_scope_state = {
							every_scope_pop = {
								limit = {
									culture = cu:greek
								}
								move_pop = root.capital
							}
						}
					}
				}
			}
			if = {
				limit = {
					NOT = { owns_entire_state_region = STATE_TRABZON }
				}
				s:STATE_TRABZON = {
					remove_homeland = cu:greek
					custom_tooltip = {
						text = move_greeks_tt
						every_scope_state = {
							every_scope_pop = {
								limit = {
									culture = cu:greek
								}
								move_pop = root.capital
							}
						}
					}
				}
			}
		}
		else_if = {
			limit = {
				has_variable = embrace_megali_idea_var
			}
			scope:ruler_scope = {
				add_modifier = {
					name = greek_ruler_negative_popularity_2
					days = very_long_modifier_time
					is_decaying = yes
				}
			}
			add_modifier = {
				name = greek_nationalism_failure_2
				days = very_long_modifier_time
				is_decaying = yes
			}
		}
		else = {
			scope:ruler_scope = {
				add_modifier = {
					name = greek_ruler_negative_popularity_1
					days = very_long_modifier_time
					is_decaying = yes
				}
			}
			add_modifier = {
				name = greek_nationalism_failure_1
				days = very_long_modifier_time
				is_decaying = yes
			}
		}
		every_interest_group = {
			limit = {
				is_in_government = yes
			}
			add_modifier = {
				name = failed_greek_je_ig_attraction
				days = very_long_modifier_time
				is_decaying = yes
			}
		}
		if = {
			limit = {
				any_interest_group = {
					ig_counts_as_marginal = no
					is_in_government = no
				}
			}
			every_interest_group = {
				limit = {
					ig_counts_as_marginal = no
					is_in_government = no
				}
				add_modifier = {
					name = failed_greek_je_opposition_ig_pol_str
					days = very_long_modifier_time
					is_decaying = yes
				}
			}
		}
	}
}

# je_greek_nationalism Annex Ionian Islands event for overlord
greece.6 = {
	type = country_event

	title = greece.6.t
	desc = greece.6.d
	flavor = greece.6.f

	placement = scope:ionian_overlord_capital

	event_image = {
		video = "unspecific_signed_contract"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"

	duration = 3

	trigger = {
		# triggered by ionian_islands_button in je_greek_nationalism
	}

	immediate = {
		c:ION ?= {
			save_scope_as = ionian_country
			top_overlord = {
				save_scope_as = ionian_overlord
				capital = {
					save_scope_as = ionian_overlord_capital
				}
			}
		}
		c:GRE ?= {
			save_scope_as = greek_country
		}
	}

	cancellation_trigger = {
		NOT = {
			exists = scope:ionian_overlord
		}
	}

	option = {
		name = greece.6.a
		default_option = yes
		scope:greek_country = {
			custom_tooltip = {
				text = ion_will_be_annexed
			}
			trigger_event = {
				id = greece.3
				days = 0
				popup = yes
			}
		}
	}
	option = {
		name = greece.6.b
		trigger = { # Player can choose the ahistorical option to reject the proposal.
			is_player = yes
		}
		scope:greek_country = {
			create_diplomatic_catalyst = {
				type = catalyst_event_negative
				target = root
			}
			post_notification = ion_proposal_rejected_message
		}
		change_infamy = 5
	}
}
