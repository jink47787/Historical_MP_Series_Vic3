button_reestablish_new_spain = {
	name = "button_reestablish_new_spain"
	desc = "button_reestablish_new_spain_desc"

	visible = {
		NOT = {
			has_variable = button_reestablish_new_spain_var
		}
	}

	possible = {
		country_or_subject_owns_entire_state_region = STATE_MEXICO
		sr:region_mexico = {
			any_scope_state = {
				OR = {
					owner = root
					owner = {
						is_subject_of = root
					}
					owner = {
						is_country_type = decentralized
					}
				}
				percent >= 0.7
			}
		}
		sr:region_central_america = {
			any_scope_state = {
				OR = {
					owner = root
					owner = {
						is_subject_of = root
					}
					owner = {
						is_country_type = decentralized
					}
				}
				percent >= 0.7
			}
		}
		custom_tooltip = {
			text = new_world_colonies_cooldown
			NOR = {
				has_variable = setting_up_new_spain_var
				has_variable = setting_up_new_grenada_var
				has_variable = setting_up_peru_var
				has_variable = setting_up_la_plata_var
				has_variable = setting_up_caribbean_var
			}
		}
	}

	effect = {
		set_variable = button_reestablish_new_spain_var
		set_variable = {
			name = setting_up_new_spain_var
			days = very_short_modifier_time
		}
		s:STATE_MEXICO = {
			random_scope_state = {
				limit = {
					OR = {
						owner = root
						owner = {
							is_subject_of = root
						}
					}
				}
				save_temporary_scope_as = mexico_state_scope
			}
		}
		hidden_effect = {
			create_country = {
				origin = root
				tag = SC1
				state = scope:mexico_state_scope
				on_created = {
				}
			}
		}
		trigger_event = { 
			id = spanish_new_world_events.4
			popup = yes 
		}
	}

	ai_chance = {
		value = 10
	}
}

button_reestablish_new_grenada = {
	name = "button_reestablish_new_grenada"
	desc = "button_reestablish_new_grenada_desc"

	visible = {
		NOT = {
			has_variable = button_reestablish_new_grenada_var
		}
	}

	possible = {
		country_or_subject_owns_entire_state_region = STATE_CUNDINAMARCA
		sr:region_gran_colombia = {
			any_scope_state = {
				OR = {
					owner = root
					owner = {
						is_subject_of = root
					}
					owner = {
						is_country_type = decentralized
					}
					state_region = s:STATE_GUAYANA
				}
				percent >= 0.7
			}
		}
		custom_tooltip = {
			text = new_world_colonies_cooldown
			NOR = {
				has_variable = setting_up_new_spain_var
				has_variable = setting_up_new_grenada_var
				has_variable = setting_up_peru_var
				has_variable = setting_up_la_plata_var
				has_variable = setting_up_caribbean_var
			}
		}
	}

	effect = {
		set_variable = button_reestablish_new_grenada_var
		set_variable = {
			name = setting_up_new_grenada_var
			days = very_short_modifier_time
		}
		s:STATE_CUNDINAMARCA = {
			random_scope_state = {
				limit = {
					OR = {
						owner = root
						owner = {
							is_subject_of = root
						}
					}
				}
				save_temporary_scope_as = cundinamarca_state_scope
			}
		}
		hidden_effect = {
			create_country = {
				origin = root
				tag = SC2
				state = scope:cundinamarca_state_scope
				on_created = {
				}
			}
		}
		trigger_event = { 
			id = spanish_new_world_events.4
			popup = yes 
		}
	}

	ai_chance = {
		value = 10
	}
}

button_reestablish_peru = {
	name = "button_reestablish_peru"
	desc = "button_reestablish_peru_desc"

	visible = {
		NOT = {
			has_variable = button_reestablish_peru_var
		}
	}

	possible = {
		country_or_subject_owns_entire_state_region = STATE_LIMA
		sr:region_andes = {
			any_scope_state = {
				OR = {
					owner = root
					owner = {
						is_subject_of = root
					}
					owner = {
						is_country_type = decentralized
					}
				}
				percent >= 0.7
			}
		}
		custom_tooltip = {
			text = new_world_colonies_cooldown
			NOR = {
				has_variable = setting_up_new_spain_var
				has_variable = setting_up_new_grenada_var
				has_variable = setting_up_peru_var
				has_variable = setting_up_la_plata_var
				has_variable = setting_up_caribbean_var
			}
		}
	}

	effect = {
		set_variable = button_reestablish_peru_var
		set_variable = {
			name = setting_up_peru_var
			days = very_short_modifier_time
		}
		s:STATE_LIMA = {
			random_scope_state = {
				limit = {
					OR = {
						owner = root
						owner = {
							is_subject_of = root
						}
					}
				}
				save_temporary_scope_as = lima_state_scope
			}
		}
		hidden_effect = {
			create_country = {
				origin = root
				tag = SC3
				state = scope:lima_state_scope
				on_created = {
				}
			}
		}
		trigger_event = { 
			id = spanish_new_world_events.4
			popup = yes 
		}
	}

	ai_chance = {
		value = 10
	}
}

button_reestablish_la_plata = {
	name = "button_reestablish_la_plata"
	desc = "button_reestablish_la_plata_desc"

	visible = {
		NOT = {
			has_variable = button_reestablish_la_plata_var
		}
	}

	possible = {
		OR = {
			s:STATE_BUENOS_AIRES = {
				any_scope_state = {
					OR = {
						owner = root
						owner = {
							is_subject_of = root
						}
						owner = {
							is_country_type = decentralized
						}						
					}
					count = all
				}
			}
		}
		sr:region_la_plata = {
			any_scope_state = {
				OR = {
					owner = root
					owner = {
						is_subject_of = root
					}
					owner = {
						is_country_type = decentralized
					}
				}
				percent >= 0.7
			}
		}
		custom_tooltip = {
			text = new_world_colonies_cooldown
			NOR = {
				has_variable = setting_up_new_spain_var
				has_variable = setting_up_new_grenada_var
				has_variable = setting_up_peru_var
				has_variable = setting_up_la_plata_var
				has_variable = setting_up_caribbean_var
			}
		}
	}

	effect = {
		set_variable = button_reestablish_la_plata_var
		set_variable = {
			name = setting_up_la_plata_var
			days = very_short_modifier_time
		}
		s:STATE_BUENOS_AIRES = {
			random_scope_state = {
				limit = {
					OR = {
						owner = root
						owner = {
							is_subject_of = root
						}
					}
				}
				save_temporary_scope_as = buenos_aires_state_scope
			}
		}
		hidden_effect = {
			create_country = {
				origin = root
				tag = SC4
				state = scope:buenos_aires_state_scope
				on_created = {
				}
			}
		}
		trigger_event = { 
			id = spanish_new_world_events.4
			popup = yes 
		}
	}

	ai_chance = {
		value = 10
	}
}

button_reestablish_caribbean = {
	name = "button_reestablish_caribbean"
	desc = "button_reestablish_caribbean_desc"

	visible = {
		NOT = {
			has_variable = button_reestablish_caribbean_var
		}
	}

	possible = {
		c:CUB ?= {
			is_subject_of = root
		}
		sr:region_caribbean = {
			any_scope_state = {
				OR = {
					owner = root
					owner = {
						is_subject_of = root
					}
				}
				percent >= 0.3
			}
		}
		custom_tooltip = {
			text = reestablish_new_spain_goal_tt
			has_variable = button_reestablish_new_spain_var
		}
		custom_tooltip = {
			text = new_world_colonies_cooldown
			NOR = {
				has_variable = setting_up_new_spain_var
				has_variable = setting_up_new_grenada_var
				has_variable = setting_up_peru_var
				has_variable = setting_up_la_plata_var
				has_variable = setting_up_caribbean_var
			}
		}
	}

	effect = {
		set_variable = button_reestablish_caribbean_var
		set_variable = {
			name = setting_up_caribbean_var
			days = very_short_modifier_time
		}
		trigger_event = { 
			id = spanish_new_world_events.4
			popup = yes 
		}
	}

	ai_chance = {
		value = 10
	}
}

button_proclaim_independence = {
	name = "button_proclaim_independence"
	desc = "button_proclaim_independence_desc"

	visible = {
		always = yes
		NOT = {
			has_variable = button_proclaim_independence_var
		}
	}

	possible = {
		trigger_if = {
			limit = {
				exists = c:SPA
			}
			calc_true_if = {
				amount >= 2
				root.naval_power_projection > c:SPA.naval_power_projection
				root.army_power_projection > c:SPA.army_power_projection
				root.prestige > c:SPA.prestige
			}

		}
		trigger_if = {
			limit = {
				NOT = {
					exists = c:SPA
				}
			}	
			always = yes		
		}
	}

	effect = {
		remove_modifier = modifier_not_recognized_by_spain
		set_variable = button_proclaim_independence_var
		add_modifier = {
			name = modifier_a_show_of_strength
			days = normal_modifier_time
		}
	}

	ai_chance = {
		value = 10
	}
}
