set_negotiation_loc = { #used for negotiations, putting here for script readability. Sets loc and art. Note: One cannot save scopes in a random_list
	random_list = {
		##difficult negotiations
		1 = {
			trigger = {
				scope:ig.amenability_level >= 3
			}
			random_list = {
				1 = {
					set_variable = {
						name = negotiation_variant
						value = 1
					}
				}
				1 = {
					set_variable = {
						name = negotiation_variant
						value = 2
					}
				}
				1 = {
					set_variable = {
						name = negotiation_variant
						value = 3
					}
				}
			}
		}
		##pragmatic normal negotiations
		1 = {
			trigger = {
				scope:ig.amenability_level = 2
			}
			random_list = {
				1 = {
					set_variable = {
						name = negotiation_variant
						value = 4
					}
				}
				1 = {
					set_variable = {
						name = negotiation_variant
						value = 5
					}
				}
				1 = {
					trigger = {
						any_interest_group = {
							is_in_government = yes
							ig_counts_as_marginal = no
							supports_law = yes
						}
					}
					set_variable = {
						name = negotiation_variant
						value = 6
					}
					random_interest_group = { #used for loc
						limit = {
							is_in_government = yes
							ig_counts_as_marginal = no
							supports_law = yes
						}
						save_temporary_scope_as = supporter_law_ig
						#cannot save permanent scopes in a random list.
					}
					root = { #For loc
						set_variable = {
							name = supporting_ig
							value = scope:supporter_law_ig
						}
					}
					if = {
						limit = {
							has_variable = supporting_ig
							always = no
						}
						#Removes errors about unused variable.
					}
				}
			}
		}
		##friendly negotiations
		1 = {
			trigger = { #pragmatic normal negotiations
				scope:ig.amenability_level <= 1
			}
			random_list = {
				1 = {
					set_variable = {
						name = negotiation_variant
						value = 7
					}
				}
				1 = {
					set_variable = {
						name = negotiation_variant
						value = 8
					}
				}
				1 = {
					set_variable = {
						name = negotiation_variant
						value = 9
					}
				}
			}
		}
	}
}



set_neg_options = { ## Sets three options out of a random list of possible negotiation offers (each with their own triggers) and a "no deal" option to back out.
##Making this a scripted effect in case multiple events want to use the negotiation options. The options themselves must be manually copied over though.

	##SET OPTION A
	random_list = {
		10 = { #option 1 bribes
			set_variable = {
				name = negotiation_option_a
				value = 1
			}
		}
		10 = {#option 2 bureaucracy
			trigger = {
				neg_option_2_trigger = yes
			}
			set_variable = {
				name = negotiation_option_a
				value = 2
			}
		}
		30 = {#option 3 army size, armed forces only
			trigger = {
				neg_option_3_trigger = yes
			}
			set_variable = {
				name = negotiation_option_a
				value = 3
			}
			neg_option_3_effects = yes
		}
		20 = {#option 4 law
			trigger = {
				neg_option_4_trigger = yes
			}
			set_variable = {
				name = negotiation_option_a
				value = 4
			}
			neg_option_4_effects = yes
		}
		10 = {#option 5 buildings
			trigger = {
				neg_option_5_trigger = yes
			}
			set_variable = {
				name = negotiation_option_a
				value = 5
			}
			neg_option_5_effects = yes
		}
		10 = {#option 6 building groups
			trigger = {
				neg_option_6_trigger = yes
			}
			set_variable = {
				name = negotiation_option_a
				value = 6
			}
			neg_option_6_effects = yes
		}
		5 = {#option 7 taxes
			trigger = {
				neg_option_7_trigger = yes
			}
			modifier = {
				value = neg_option_7_modifier
			}
			set_variable = {
				name = negotiation_option_a
				value = 7
			}
			neg_option_7_effects = yes
		}
		80 = {#option 8 option, law_amendment
			trigger = {
				neg_option_8_trigger = yes
			}
			set_variable = {
				name = negotiation_option_a
				value = 8
			}
			neg_option_8_effects = yes
		}
		5 = {#option 9 SOL
			trigger = {
				neg_option_9_trigger = yes
			}
			modifier = {
				value = neg_option_9_modifier
			}
			set_variable = {
				name = negotiation_option_a
				value = 9
			}
			neg_option_9_effects = yes
		}
		1 = { #No Option. Stops unset var errors. Small chance the Gods above and Gods below say no.
			set_variable = {
				name = negotiation_option_a
				value = 1000
			}
		}
	}
	##SET OPTION B
	random_list = {
		10 = {#option 1 bribes
			trigger = {
				NOT = {
					var:negotiation_option_a = 1
				}
			}
			set_variable = {
				name = negotiation_option_b
				value = 1
			}
		}
		10 = {#option 2 bureaucracy
			trigger = {
				NOT = {
					var:negotiation_option_a = 2
				}
				neg_option_2_trigger = yes
			}
			set_variable = {
				name = negotiation_option_b
				value = 2
			}
		}
		30 = {#option 3 army size, armed forces only
			trigger = {
				NOT = {
					var:negotiation_option_a = 3
				}
				neg_option_3_trigger = yes
			}
			set_variable = {
				name = negotiation_option_b
				value = 3
			}
			neg_option_3_effects = yes
		}
		20 = {#option 4 law
			trigger = {
				NOT = {
					var:negotiation_option_a = 4
				}
				neg_option_4_trigger = yes
			}
			set_variable = {
				name = negotiation_option_b
				value = 4
			}
			neg_option_4_effects = yes
		}
		10 = {#option 5 buildings
			trigger = {
				NOT = {
					var:negotiation_option_a = 5
				}
				neg_option_5_trigger = yes
			}
			set_variable = {
				name = negotiation_option_b
				value = 5
			}
			neg_option_5_effects = yes
		}
		10 = {#option 6 building groups
			trigger = {
				NOT = {
					var:negotiation_option_a = 6
				}
				neg_option_6_trigger = yes
			}
			set_variable = {
				name = negotiation_option_b
				value = 6
			}
			neg_option_6_effects = yes
		}
		5 = {#option 7 taxes
			trigger = {
				NOT = {
					var:negotiation_option_a = 7
				}
				neg_option_7_trigger = yes
			}
			modifier = {
				value = neg_option_7_modifier
			}
			set_variable = {
				name = negotiation_option_b
				value = 7
			}
			neg_option_7_effects = yes
		}
		80 = {#option 8 option, law_amendment
			trigger = {
				NOT = {
					var:negotiation_option_a = 8
				}
				neg_option_8_trigger = yes
			}
			set_variable = {
				name = negotiation_option_b
				value = 8
			}
			neg_option_8_effects = yes
		}
		5 = {#option 9 SOL
			trigger = {
				NOT = {
					var:negotiation_option_a = 9
				}
				neg_option_9_trigger = yes
			}
			modifier = {
				value = neg_option_9_modifier
			}
			set_variable = {
				name = negotiation_option_b
				value = 9
			}
			neg_option_9_effects = yes
		}
		1 = { #No Option. Stops unset var errors. Bad luck strikes
			set_variable = {
				name = negotiation_option_b
				value = 1000
			}
		}
	}
	##SET OPTION C
	random_list = {
		10 = {#option 1 bribes
			trigger = {
				NOR = {
					var:negotiation_option_a = 1
					var:negotiation_option_b = 1
				}
			}
			set_variable = {
				name = negotiation_option_c
				value = 1
			}
		}
		10 = {#option 2 bureaucracy
			trigger = {
				NOR = {
					var:negotiation_option_a = 2
					var:negotiation_option_b = 2
				}
				neg_option_2_trigger = yes
			}
			set_variable = {
				name = negotiation_option_c
				value = 2
			}
		}
		30 = {#option 3 army size, armed forces only
			trigger = {
				NOR = {
					var:negotiation_option_a = 3
					var:negotiation_option_b = 3
				}
				neg_option_3_trigger = yes
			}
			set_variable = {
				name = negotiation_option_c
				value = 3
			}
			neg_option_3_effects = yes
		}
		20 = {#option 4 law
			trigger = {
				NOT = {
					var:negotiation_option_a = 4
					var:negotiation_option_b = 4
				}
				neg_option_4_trigger = yes
			}
			set_variable = {
				name = negotiation_option_c
				value = 4
			}
			neg_option_4_effects = yes
		}
		10 = {#option 5 buildings
			trigger = {
				NOT = {
					var:negotiation_option_a = 5
					var:negotiation_option_b = 5
				}
				neg_option_5_trigger = yes
			}
			set_variable = {
				name = negotiation_option_c
				value = 5
			}
			neg_option_5_effects = yes
		}
		10 = {#option 6 building groups
			trigger = {
				NOT = {
					var:negotiation_option_a = 6
					var:negotiation_option_b = 6
				}
				neg_option_6_trigger = yes
			}
			set_variable = {
				name = negotiation_option_c
				value = 6
			}
			neg_option_6_effects = yes
		}
		5 = {#option 7 taxes
			trigger = {
				NOT = {
					var:negotiation_option_a = 7
					var:negotiation_option_b = 7
				}
				neg_option_7_trigger = yes
			}
			modifier = {
				value = neg_option_7_modifier
			}
			set_variable = {
				name = negotiation_option_c
				value = 7
			}
			neg_option_7_effects = yes
		}
		80 = {#option 8 option, law_amendment
			trigger = {
				NOT = {
					var:negotiation_option_a = 8
					var:negotiation_option_b = 8
				}
				neg_option_8_trigger = yes
			}
			set_variable = {
				name = negotiation_option_c
				value = 8
			}
			neg_option_8_effects = yes
		}
		5 = {#option 9
			trigger = {
				NOT = {
					var:negotiation_option_a = 9
					var:negotiation_option_b = 9
				}
				neg_option_9_trigger = yes
			}
			modifier = {
				value = neg_option_9_modifier
			}
			set_variable = {
				name = negotiation_option_c
				value = 9
			}
			neg_option_9_effects = yes
		}
		1 = { #No Option. Stops unset var errors.
			set_variable = {
				name = negotiation_option_c
				value = 1000
			}
		}
	}
}

je_government_petition_negotiation_immediate = {
    random_interest_group = {
        limit = {
            has_variable = ig_new_quest_starting
            has_variable = promise_quest_type
            var:promise_quest_type = 2 #law
        }
        save_scope_as = ig
        remove_variable = ig_new_quest_starting
    }
    scope:ig.var:desired_law_var = {
        save_scope_as = government_petition_law
    }
    currently_enacting_law = {
		save_scope_as = law
	}
	scope:ig = {
		set_variable = {
			name = law_attempt_months
			value = 0
		}
	}
    ## scope:ig already has var:promise_quest_degree
}

je_government_petition_negotiation_monthly_pulse = {
	if = {
		limit = {
			is_enacting_law = scope:government_petition_law.type
		}
		scope:ig = {
			change_variable = {
				name = law_attempt_months
				add = 1
			}
		}
	}
}

je_government_petition_negotiation_yearly_pulse = {
	#they help you pass the law if enactment chance is smaller than stall.
	if = {
		limit = {
			is_enacting_law = scope:government_petition_law.type
			enactment_chance < "stall_chance"
		}
		post_notification = help_from_ig
		#different scales of help depending on how far behind enactment chance is.
		if = {
			limit = {
				enactment_chance >= {
					value = "stall_chance"
					add = -15
				}
			}
			add_enactment_modifier = {
				name = negotiation_pushing_for_law
			}
		}
		else_if = {
			limit = {
				enactment_chance >= {
					value = "stall_chance"
					add = -30
				}
			}
			add_enactment_modifier = {
				name = negotiation_pushing_for_law
				multiplier = 2
			}
		}
		else_if = {
			limit = {
				enactment_chance >= {
					value = "stall_chance"
					add = -45
				}
			}
			add_enactment_modifier = {
				name = negotiation_pushing_for_law
				multiplier = 3
			}
		}
		else_if = {
			limit = {
				enactment_chance >= {
					value = "stall_chance"
					add = -100
				}
			}
			add_enactment_modifier = {
				name = negotiation_pushing_for_law
				multiplier = 4
			}
		}
	}
}
