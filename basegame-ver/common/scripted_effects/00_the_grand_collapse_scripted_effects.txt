the_grand_collapse_happens_balkans = {
    # release countries if they dont exist
    if = {
        limit = {
            NOT = {
                exists = c:ALB
            }
            any_scope_state = {
                OR = {
                    region = sr:region_balkans
                    region = sr:region_danubia
                }
                state_region = {
                    is_homeland = cu:albanian
                }
            }
        }
        random_scope_state = {
            limit = {
                OR = {
                    region = sr:region_balkans
                    region = sr:region_danubia
                }
                state_region = {
                    is_homeland = cu:albanian
                }
            }
            save_scope_as = albania_scope
        }
        create_country = {
            tag = ALB
            origin = root

            state = scope:albania_scope
        }
    }
    if = {
        limit = {
            NOT = {
                exists = c:BUL
            }
            any_scope_state = {
                OR = {
                    region = sr:region_balkans
                    region = sr:region_danubia
                }
                state_region = {
                    is_homeland = cu:bulgarian
                }
            }
        }
        random_scope_state = {
            limit = {
                OR = {
                    region = sr:region_balkans
                    region = sr:region_danubia
                }
                state_region = {
                    is_homeland = cu:bulgarian
                }
            }
            save_scope_as = bulgaria_scope
        }
        create_country = {
            tag = BUL
            origin = root

            state = scope:bulgaria_scope
        }
    }
    if = {
        limit = {
            NOT = {
                exists = c:BOS
            }
            any_scope_state = {
                OR = {
                    region = sr:region_balkans
                    region = sr:region_danubia
                }
                state_region = {
                    is_homeland = cu:bosniak
                }
            }
        }
        random_scope_state = {
            limit = {
                OR = {
                    region = sr:region_balkans
                    region = sr:region_danubia
                }
                state_region = {
                    is_homeland = cu:bosniak
                }
            }
            save_scope_as = bosnia_scope
        }
        create_country = {
            tag = BOS
            origin = root

            state = scope:bosnia_scope
        }
    }
    if = {
        limit = {
            NOT = {
                exists = c:CRO
            }
            any_scope_state = {
                OR = {
                    region = sr:region_balkans
                    region = sr:region_danubia
                }
                state_region = {
                    is_homeland = cu:croat
                }
            }
        }
        random_scope_state = {
            limit = {
                OR = {
                    region = sr:region_balkans
                    region = sr:region_danubia
                }
                state_region = {
                    is_homeland = cu:croat
                }
            }
            save_scope_as = croatia_scope
        }
        create_country = {
            tag = CRO
            origin = root

            state = scope:croatia_scope
        }
    }
    if = {
        limit = {
            NOT = {
                exists = c:MON
            }
            exists = s:STATE_MONTENEGRO.region_state:TUR
        }
        s:STATE_MONTENEGRO.region_state:TUR = {
            save_scope_as = montenegro_scope
        }
        create_country = {
            tag = MON
            origin = root

            state = scope:montenegro_scope
        }
    }
    if = {
        limit = {
            NOT = {
                exists = c:SER
            }
            any_scope_state = {
                OR = {
                    region = sr:region_balkans
                    region = sr:region_danubia
                }
                state_region = {
                    is_homeland = cu:serb
                }
            }
        }
        random_scope_state = {
            limit = {
                OR = {
                    region = sr:region_balkans
                    region = sr:region_danubia
                }
                state_region = {
                    is_homeland = cu:serb
                }
            }
            save_scope_as = serbia_scope
        }
        create_country = {
            tag = SER
            origin = root

            state = scope:serbia_scope
        }
    }
    if = {
        limit = {
            NOT = {
                exists = c:GRE
            }
            any_scope_state = {
                OR = {
                    region = sr:region_balkans
                    region = sr:region_danubia
                }
                state_region = {
                    is_homeland = cu:greek
                }
            }
        }
        random_scope_state = {
            limit = {
                OR = {
                    region = sr:region_balkans
                    region = sr:region_danubia
                }
                state_region = {
                    is_homeland = cu:greek
                }
            }
            save_scope_as = greece_scope
        }
        create_country = {
            tag = GRE
            origin = root

            state = scope:greece_scope
        }
    }
    if = {
        limit = {
            NOT = {
                exists = c:WAL
            }
            exists = s:STATE_WALLACHIA.region_state:TUR
        }
        s:STATE_WALLACHIA.region_state:TUR = {
            save_scope_as = wallachia_scope
        }
        create_country = {
            tag = WAL
            origin = root

            state = scope:wallachia_scope
        }
    }
    if = {
        limit = {
            NOT = {
                exists = c:MOL
            }
            exists = s:STATE_MOLDAVIA.region_state:TUR
        }
        s:STATE_MOLDAVIA.region_state:TUR = {
            save_scope_as = moldavia_scope
        }
        create_country = {
            tag = MOL
            origin = root

            state = scope:moldavia_scope
        }
    }

    # divide up states
    while = {
        limit = {
            any_scope_state = {
                OR = {
                    region = sr:region_balkans
                    region = sr:region_danubia
                }
            }
        }
        random_country = {
            limit = {
                capital = {
                    OR = {
                        region = sr:region_balkans
                        region = sr:region_danubia
                    }
                }
                any_neighbouring_state = {
                    is_homeland_of_country_cultures = prev
                    owner = root
                }
            }
            save_scope_as = new_owner_scope
        }
        random_scope_state = {
            limit = {
                OR = {
                    region = sr:region_balkans
                    region = sr:region_danubia
                }
                is_homeland_of_country_cultures = scope:new_owner_scope
                any_neighbouring_state = {
                    owner = scope:new_owner_scope
                }
            }
            set_state_owner = scope:new_owner_scope
        }
        clear_saved_scope = new_owner_scope
    }
}

the_grand_collapse_happens_asia_africa = {

        # Make all subjects independent
        every_subject_or_below = {
            limit = {
                is_direct_subject_of = ROOT
            }
            make_independent = yes
        }

        # BOSNIA #
        if = {
            limit = {
                exists = s:STATE_BOSNIA.region_state:TUR
                NOT = {
                    exists = c:BOS
                }
            }

            create_country = { # BOSNIA
                tag = BOS
                origin = this
                state = s:STATE_BOSNIA.region_state:TUR
                on_created = {
                }
            }
            c:BOS ?= { save_scope_as = scope_BOS }
        }

        # CYPRUS #
        if = {
            limit = {
                exists = s:STATE_CYPRUS.region_state:TUR
                NOT = {
                    exists = c:CYP
                }
            }

            create_country = { # BOSNIA
                tag = CYP
                origin = this
                state = s:STATE_CYPRUS.region_state:TUR
                on_created = {
                }
            }
            c:CYP ?= { save_scope_as = scope_CYP }
        }

        # ARMENIA #
        if = {
            limit = {
                any_scope_state = {
                    state_region = {
                        is_homeland = cu:armenian
                    }
                }
                NOT = {
                    exists = c:ARM
                }
            }
            random_scope_state = {
                limit = {
                    state_region = {
                        is_homeland = cu:armenian
                    }
                }
                save_scope_as = armenia_scope
            }
            create_country = {
                tag = ARM
                origin = this
                state = scope:armenia_scope
                on_created = {
                }
            }
            c:ARM ?= { save_scope_as = scope_ARM }
        }

        # IRAQ #
        if = {
            limit = {
                any_scope_state = {
                    state_region = {
                        is_homeland = cu:mashriqi
                    }
                }
                NOT = {
                    exists = c:IRQ
                }
            }
            random_scope_state = {
                limit = {
                    state_region = {
                        is_homeland = cu:mashriqi
                    }
                }
                save_scope_as = iraq_scope
            }
            create_country = {
                tag = IRQ
                origin = this
                state = scope:iraq_scope
                on_created = {
                }
            }
            c:IRQ ?= { save_scope_as = scope_IRQ }
        }

        # SYRIA #
        if = {
            limit = {
                any_scope_state = {
                    state_region = {
                        is_homeland = cu:mashriqi
                    }
                }
                NOT = {
                    exists = c:SYR
                }
            }
            random_scope_state = {
                limit = {
                    state_region = {
                        is_homeland = cu:mashriqi
                    }
                }
                save_scope_as = syria_scope
            }
            create_country = {
                tag = SYR
                origin = this
                state = scope:syria_scope
                on_created = {
                }
            }
            c:SYR ?= { save_scope_as = scope_SYR }
        }

        # KURDISTAN #
        if = {
            limit = {
                any_scope_state = {
                    state_region = {
                        is_homeland = cu:kurdish
                    }
                }
                NOT = {
                    exists = c:KUR
                }
            }
            random_scope_state = {
                limit = {
                    state_region = {
                        is_homeland = cu:kurdish
                    }
                }
                save_scope_as = kurdistan_scope
            }
            create_country = {
                tag = KUR
                origin = this
                state = scope:kurdistan_scope
                on_created = {
                }
            }
            c:KUR ?= { save_scope_as = scope_KUR }
        }

        # ASSYRIA #
        if = {
            limit = {
                any_scope_state = {
                    state_region = {
                        is_homeland = cu:assyrian
                    }
                }
                NOT = {
                    exists = c:ASS
                }
            }
            random_scope_state = {
                limit = {
                    state_region = {
                        is_homeland = cu:assyrian
                    }
                }
                save_scope_as = assyria_scope
            }
            create_country = {
                tag = ASS
                origin = this
                state = scope:assyria_scope
                on_created = {
                }
            }
            c:ASS ?= { save_scope_as = scope_ASS }
        }

        # GEORGIA #
        if = {
            limit = {
                any_scope_state = {
                    state_region = {
                        is_homeland = cu:georgian
                    }
                }
                NOT = {
                    exists = c:GEO
                }
            }
            random_scope_state = {
                limit = {
                    state_region = {
                        is_homeland = cu:georgian
                    }
                }
                save_scope_as = georgia_scope
            }
            create_country = {
                tag = GEO
                origin = this
                state = scope:georgia_scope
                on_created = {
                }
            }
            c:GEO ?= { save_scope_as = scope_GEO }
        }

        # EGYPT #
        if = {
            limit = {
                any_scope_state = {
                    state_region = {
                        is_homeland = cu:misri
                    }
                }
                NOT = {
                    exists = c:EGY
                }
            }
            random_scope_state = {
                limit = {
                    state_region = {
                        is_homeland = cu:misri
                    }
                }
                save_scope_as = egypt_scope
            }
            create_country = {
                tag = EGY
                origin = this
                state = scope:egypt_scope
                on_created = {
                }
            }
            c:EGY ?= { save_scope_as = scope_EGY }
        }

        # TRIPOLITANIA #
        if = {
            limit = {
                any_scope_state = {
                    state_region = {
                        is_homeland = cu:maghrebi
                    }
                }
                NOT = {
                    exists = c:TRI
                }
            }
            random_scope_state = {
                limit = {
                    state_region = {
                        is_homeland = cu:maghrebi
                    }
                }
                save_scope_as = tripolitania_scope
            }
            create_country = {
                tag = TRI
                origin = this
                state = scope:tripolitania_scope
                on_created = {
                }
            }
            c:TRI ?= { save_scope_as = scope_TRI }
        }

        # TUNISIA #
        if = {
            limit = {
                any_scope_state = {
                    state_region = {
                        OR = {
                        is_homeland = cu:maghrebi
                        is_homeland = cu:berber
                        is_homeland = cu:bidan
                        }
                    }
                }
                NOT = {
                    exists = c:TUN
                }
            }
            random_scope_state = {
                limit = {
                    state_region = {
                        OR = {
                        is_homeland = cu:maghrebi
                        is_homeland = cu:berber
                        is_homeland = cu:bidan
                        }
                    }
                }
                save_scope_as = tunisia_scope
            }
            create_country = {
                tag = TUN
                origin = this
                state = scope:tunisia_scope
                on_created = {
                }
            }
            c:TUN ?= { save_scope_as = scope_TUN }
        }

        # Give all remote states to a random neighbouring country
                while = {
                    limit = {
                        any_scope_state = {
                            NOT = {
                                region = sr:region_anatolia
                            }
                        }
                    }
                    random_scope_state = {
                        limit = {
                            NOT = {
                                region = sr:region_anatolia
                            }
                            any_neighbouring_state = {
                                owner = {
                                    NOT = {
                                        this = c:TUR
                                    }
                                }
                            }
                        }
                        save_scope_as = remote_collapse_state_scope
                    }

                    if = {
                        limit = {
                            exists = scope:remote_collapse_state_scope
                        }
                    scope:remote_collapse_state_scope = {
                        random_neighbouring_state = {
                            limit = {
                                NOT = {
                                    owner = c:TUR
                                }
                            }
                            save_scope_as = neighbour_country_state_scope
                        }
                        set_state_owner = scope:neighbour_country_state_scope.owner
                    }
                }
                clear_saved_scope = remote_collapse_state_scope
                clear_saved_scope = neighbour_country_state_scope
            }
    }

        # Divide cultural homeland states to created countries
        while = {
                random_country = {
                    limit = {
                        OR = {
                            c:ARM ?= this
                            c:IRQ ?= this
                            c:SYR ?= this
                            c:KUR ?= this
                            c:ASS ?= this
                            c:GEO ?= this
                            c:EGY ?= this
                            c:TRI ?= this
                            c:TUN ?= this
                        }
                        exists = this
                        is_subject = no
                        any_neighbouring_state = {
                            is_homeland_of_country_cultures = this
                            owner = root
                        }
                    }
                    save_scope_as = new_owner_scope
                }
                if = {
                    limit = {
                        exists = scope:new_owner_scope
                    }
                        random_scope_state = {
                        limit = {
                            is_homeland_of_country_cultures = scope:new_owner_scope
                            any_neighbouring_state = {
                                owner = scope:new_owner_scope
                            }
                        }
                        set_state_owner = scope:new_owner_scope
                    }
                }
                clear_saved_scope = new_owner_scope
            }

desperate_measures_ig_approval_mod_effect = {
    if = {
        limit = {
            is_interest_group_type = ig_devout
        }
        ROOT = {
            add_modifier = {
                name = the_grand_collapse_desperate_measures_devout
                days = short_modifier_time
            }
        }
    }

    else_if = {
        limit = {
            is_interest_group_type = ig_industrialists
        }
        ROOT = {
            add_modifier = {
                name = the_grand_collapse_desperate_measures_industrialists
                days = short_modifier_time
            }
        }
        add_modifier = {
            name = the_grand_collapse_desperate_measures_industrialists
            days = short_modifier_time
        }
    }

    else_if = {
        limit = {
            is_interest_group_type = ig_intelligentsia
        }
        ROOT = {
            add_modifier = {
                name = the_grand_collapse_desperate_measures_intelligentsia
                days = short_modifier_time
            }
        }

    }

    else_if = {
        limit = {
            is_interest_group_type = ig_landowners
        }
        ROOT = {
            add_modifier = {
                name = the_grand_collapse_desperate_measures_landowners
                days = short_modifier_time
            }
        }

    }

    else_if = {
        limit = {
            is_interest_group_type = ig_armed_forces
        }
        ROOT = {
            add_modifier = {
                name = the_grand_collapse_desperate_measures_armed_forces
                days = short_modifier_time
            }
        }

    }

    else_if = {
        limit = {
            is_interest_group_type = ig_petty_bourgeoisie
        }
        ROOT = {
            add_modifier = {
                name = the_grand_collapse_desperate_measures_petty_bourgeoisie
                days = short_modifier_time
            }
        }

    }

    else_if = {
        limit = {
            is_interest_group_type = ig_rural_folk
        }
        ROOT = {
            add_modifier = {
                name = the_grand_collapse_desperate_measures_rural_folk
                days = short_modifier_time
            }
        }

    }

    else_if = {
        limit = {
            is_interest_group_type = ig_trade_unions
        }
        ROOT = {
            add_modifier = {
                name = the_grand_collapse_desperate_measures_trade_unions
                days = short_modifier_time
            }
        }

    }
}

the_grand_collapse_mod_cleanser = {
    remove_modifier = the_grand_collapse_law_speed_mod
    remove_modifier = the_grand_collapse_relation_speed_mod
    remove_modifier = the_grand_collapse_main_mod
}
