je_spain_provisional_government = {
	icon = "gfx/interface/icons/event_icons/event_scales.dds"

	group = je_group_historical_content

	scripted_button = je_spain_provisional_government_portuguese_button
	scripted_button = je_spain_provisional_government_espartero_button
	scripted_button = je_spain_provisional_government_hohenzollern_button
	scripted_button = je_spain_provisional_government_italian_button
	scripted_button = je_spain_provisional_government_isabelist_button
	scripted_button = je_spain_provisional_government_carlist_button
	scripted_button = je_spain_provisional_government_bonaparte_button
	scripted_button = je_spain_provisional_government_republic_button

	immediate = {
		ROOT = {
			save_scope_as = spain_scope
		}
	}

	complete = {
        custom_tooltip = {
            text = successfully_crowned_a_king_tt
            has_gov_regency = no
        }
	}

	on_complete = {
		custom_tooltip = spain_ends_regency_tt
		set_variable = finished_glorious_revolution_var
		if = {
			limit = {
				has_variable = spa_couped_dynasty
			}
			remove_variable = spa_couped_dynasty
		}
		if = {
			limit = {
				has_variable = king_searching_var
			}
			remove_variable = king_searching_var
		}
		if = {
			limit = {
				has_variable = glorious_revolution_coup_var
			}
			remove_variable = glorious_revolution_coup_var
		}
	}

    fail = {
        NOT = {
            has_law = law_type:law_monarchy
        }
    }

	on_fail = {
		set_variable = finished_glorious_revolution_var
		if = {
			limit = {
				has_variable = spa_couped_dynasty
			}
			remove_variable = spa_couped_dynasty
		}
		if = {
			limit = {
				has_variable = king_searching_var
			}
			remove_variable = king_searching_var
		}
		if = {
			limit = {
				has_variable = glorious_revolution_coup_var
			}
			remove_variable = glorious_revolution_coup_var
		}
	}

	weight = 5000

    should_be_pinned_by_default = yes
}

je_spain_glorious_revolution_dummy = {

	group = je_group_historical_content

	is_shown_when_inactive = {
		has_dlc_feature = ip4_content
		OR = {
			c:SPA ?= this
			was_formed_from = SPA
		}
		has_journal_entry = je_the_two_spains
		NOT = {
			has_variable = glorious_revolution_var
		}
	}

	possible = {
		custom_tooltip = {
			text = has_had_successful_coup_whilst_conditions_are_fulfilled_tt
			always = no
		}
		has_journal_entry = je_the_two_spains
		has_law = law_type:law_monarchy
		custom_tooltip = {
			text = two_spains_tension_over_50_tt
			var:two_spains_tension_current_var >= 50
		}
		ruler ?= { popularity <= define:NCharacters|POPULARITY_LIKED_THRESHOLD }
		custom_tooltip = {
			text = je_glorious_revolution_has_gov_regency_not_tt
			has_gov_regency = no
		}
	}

	immediate = {
		show_as_tooltip = {
			trigger_event = {
				id = two_spains.4
				popup = yes
			}
		}
	}

	weight = 5000
}
