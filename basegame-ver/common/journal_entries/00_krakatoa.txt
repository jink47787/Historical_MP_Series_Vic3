je_krakatoa = {
	icon = "gfx/interface/icons/state_trait_icons/disaster_zone.dds"

	group = je_group_crises

	scripted_progress_bar = je_krakatoa_thermometer_progress_bar

	on_monthly_pulse = {
		random_events = {
			10 = 0
			2 = krakatoa.4 #art boom
			5 = krakatoa.3 #crop failure
		}

		effect = {
			trigger_event = {
				on_action = krakatoa_on_action
			}
		}
	}

	immediate = {
		if = {
			limit = {
				any_scope_state = {
					AND = {
						devastation > 0
						state_region = {
							has_variable = is_tsunami_state
						}
					}
				}
			}
			every_scope_state = {
				limit = {
					AND = {
						devastation > 0
						state_region = {
							has_variable = is_tsunami_state
						}
					}
				}
				root = {
					add_to_variable_list = {
						name = krakatoa_states
						target = prev
					}
				}
			}
		}
	}

	on_weekly_pulse = {
		effect = {
			clear_variable_list = krakatoa_states
			if = {
				limit = {
					any_scope_state = {
						AND = {
							devastation > 0
							state_region = {
								has_variable = is_tsunami_state
							}
						}
					}
				}
				every_scope_state = {
					limit = {
						AND = {
							devastation > 0
							state_region = {
								has_variable = is_tsunami_state
							}
						}
					}
					root = {
						add_to_variable_list = {
							name = krakatoa_states
							target = prev
						}
					}
				}
			}
		}
	}

	on_timeout = {
		clear_variable_list = krakatoa_states
		if = {
			limit = {
				exists = global_var:krakatoa_temperature_drop
				exists = global_var:krakatoa_temperature_recovery_rate
			}
			remove_global_variable = krakatoa_temperature_drop
			remove_global_variable = krakatoa_temperature_recovery_rate
		}
	}

	timeout = normal_modifier_time

	weight = 100

	should_be_pinned_by_default = yes

	transferable = yes
}
