# Dummy JE that only serves to highlight the event 'spanish_new_world_events.1'
je_spanish_new_world_dummy = {
	icon = "gfx/interface/icons/event_icons/event_carlist_beret.dds"

	group = je_group_historical_content

	is_shown_when_inactive = {
		has_dlc_feature = ip4_content
		OR = {
			c:SPA ?= this
			c:SPC ?= this
		}
		NOT = {
			has_global_variable = je_spanish_new_world_dummy_happened_var
		}
	}

	possible = {
		hidden_trigger = {
			always = no
		}
		is_at_war = no
	}

	status_desc = {
		desc = je_spanish_new_world_dummy_status_desc
	}

	complete = {
		hidden_trigger = {}
	}

	immediate = {
		show_as_tooltip = {
			trigger_event = {
				id = spanish_new_world_events.1
				popup = yes
			}
		}
	}

	event_outcome_activated_effect_desc = {
	 	header = spanish_new_world_events.1.a
	 	effect = {
			add_journal_entry = {
				type = je_hispanoamerica
			}
			custom_tooltip = spanish_new_world_events.1.tt_1
			add_modifier = {
				name = modifier_spanish_infamy_reduction
				days = normal_modifier_time
			}
	 	}
	}
	event_outcome_activated_effect_desc = {
	 	header = spanish_new_world_events.1.b
	 	effect = {
			add_journal_entry = {
				type = je_reconquista
			}
			custom_tooltip = spanish_new_world_events.1.tt_2
			change_infamy = 5
			custom_tooltip = {
				text = spanish_new_world_events.1.tt_4_event_insight
				every_country = {
					limit = {
						OR = {
							c:GBR ?= this
							c:USA ?= this
							AND = {
								is_historical_spanish_american_colony = yes
								NOT = {
									is_subject_of = root
								}
							}
						}
					}
					change_relations = {
						country = root
						value = -30
					}
				}
			}
			custom_tooltip = spanish_new_world_events.1.tt_3_event_insight
			custom_tooltip = {
				text = spanish_new_world_events.1.tt_5
				every_country = {
					limit = {
						has_modifier = modifier_not_recognized_by_spain
					}
					remove_modifier = modifier_not_recognized_by_spain
				}
			}
	 	}
	}

    fail = {
    	always = no
    }

	on_fail = {
	}

	weight = 6000

    should_be_pinned_by_default = yes
}

je_reconquista = {
	icon = "gfx/interface/icons/event_icons/event_military.dds"

	group = je_group_historical_content

	scripted_button = button_reestablish_new_spain
	scripted_button = button_reestablish_new_grenada
	scripted_button = button_reestablish_peru
	scripted_button = button_reestablish_la_plata
	scripted_button = button_reestablish_caribbean

	immediate = {
	}

	complete = {
		OR = {
			AND = {
				custom_tooltip = {
					text = reestablish_new_spain_goal_tt
					has_variable = button_reestablish_new_spain_var
				}
				custom_tooltip = {
					text = reestablish_new_grenada_goal_tt
					has_variable = button_reestablish_new_grenada_var
				}
				custom_tooltip = {
					text = reestablish_peru_goal_tt
					has_variable = button_reestablish_peru_var
				}
				custom_tooltip = {
					text = reestablish_la_plata_goal_tt
					has_variable = button_reestablish_la_plata_var
				}
			}
		}
	}

	on_complete = {
		trigger_event = {
			id = spanish_new_world_events.2
			popup = yes
		}
		custom_tooltip = choose_one_of_tt
		show_as_tooltip = {
			add_modifier = {
				name = modifier_our_american_empire_reward_regular
				days = long_modifier_time
			}
		}
		show_as_tooltip = {
			add_modifier = {
				name = modifier_our_american_empire_reward_military
				days = long_modifier_time
			}
		}
		custom_tooltip = je_reconquista_goal_tt
	}


    fail = {
    }

	on_fail = {
	}

	weight = 6000

    should_be_pinned_by_default = yes
}

je_hispanoamerica = {
	icon = "gfx/interface/icons/event_icons/event_trade.dds"

	group = je_group_historical_content

	immediate = {
		every_country_in_americas = {
			limit = {
				any_primary_culture = {
					has_discrimination_trait = language_hispanophone
				}
				has_modifier = modifier_not_recognized_by_spain
				NAND = {
					is_country_type = colonial
					is_subject_of = ROOT
				}
			}
			root = {
				add_to_variable_list = {
					name = hispanoamerica_recognition_countries
					target = prev
				}
			}
		}
	}

	on_weekly_pulse = {
		effect = {
			clear_variable_list = hispanoamerica_recognition_countries
			every_country_in_americas = {
				limit = {
					any_primary_culture = {
						has_discrimination_trait = language_hispanophone
					}
					has_modifier = modifier_not_recognized_by_spain
					NAND = {
						is_country_type = colonial
						is_subject_of = ROOT
					}
				}
				root = {
					add_to_variable_list = {
						name = hispanoamerica_recognition_countries
						target = prev
					}
				}
			}
		}
	}

	complete = {
		any_country_in_americas = {
			filter = {
				custom_tooltip = {
					text = FORMER_SPANISH_COLONY_TT
					any_primary_culture = {
						has_discrimination_trait = language_hispanophone
					}
					NAND = {
						is_country_type = colonial
						is_subject_of = ROOT
					}
				}
			}
			percent = 1
			NOT = {
				has_modifier = modifier_not_recognized_by_spain
			}
			custom_tooltip = HISPANOAMERICA_RECOGNITION_COUNTRIES_TT
		}
	}

	on_complete = {
		clear_variable_list = hispanoamerica_recognition_countries
		trigger_event = {
			id = spanish_new_world_events.3
			popup = yes
		}
		show_as_tooltip = {
			add_modifier = {
				name = modifier_hispanoamerica_reward
				days = long_modifier_time
			}
		}
		custom_tooltip = {
			text = je_hispanoamerica_improve_relations
		}
		custom_tooltip = {
			text = je_hispanoamerica_improve_leverage
		}
	}


    fail = {
    }

	on_fail = {
	}

	weight = 6000

    should_be_pinned_by_default = yes
}

je_spanish_american_independence = {
	icon = "gfx/interface/icons/event_icons/event_scales.dds"

	group = je_group_historical_content

	scripted_button = button_proclaim_independence

	immediate = {
		c:SPA ?= {
			save_scope_as = spain_scope
		}
	}

	complete = {
		NOT = {
			has_modifier = modifier_not_recognized_by_spain
		}
		custom_tooltip = {
			text = je_spanish_american_reconquista_tt
			NOT = {
				has_modifier = modifier_not_recognized_by_spain
			}
		}
	}

	on_complete = {
		show_as_tooltip = {
			add_modifier = {
				name = modifier_renewed_diplomatic_efforts
				days = long_modifier_time
			}
		}
		trigger_event = {
			id = spanish_new_world_events.5
		}
		if = {
			limit = {
				c:SPA ?= {
					any_scope_state = {
						is_incorporated = yes
						is_in_geographic_region = geographic_region_europe
						any_scope_culture = {
							has_homeland = prev
							culture_can_have_mass_migration_to_country = root
						}
					}
				}
			}
			custom_tooltip = je_spanish_american_optional_tt
		}
	}


    fail = {
    }

	on_fail = {
	}

	weight = 6000

    should_be_pinned_by_default = yes
}
