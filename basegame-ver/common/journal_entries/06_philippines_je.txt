je_philippines_development = {
    icon = "gfx/interface/icons/goods_icons/sugar.dds"

    group = je_group_technology

    is_shown_in_lobby = {
        c:PHI ?= this
        has_dlc_feature = ip4_content
    }

    immediate = {
        root = {
            save_scope_as = phi_scope
        }
        random_scope_state = {
            limit = {
                state_region = s:STATE_LUZON
            }
            save_scope_as = luzon_scope
        }
        random_scope_state = {
            limit = {
                state_region = s:STATE_VISAYAS
            }
            save_scope_as = visayas_scope
        }
        random_scope_state = {
            limit = {
                state_region = s:STATE_MINDANAO
            }
            save_scope_as = mindanao_scope
        }
        trigger_event = { id = philippines.9 }
    }

    complete = {
        gdp >= 2000000
        OR = {
            country_has_building_group_levels = {
                type = bg_plantations
                value >= 35
            }
            any_scope_state = {
                state_region = {
                    is_homeland = cu:filipino_mestizo
                }
                any_scope_building = {
                    is_building_type = building_urban_center
                    level >= 5
                }
            }
        }
        s:STATE_VISAYAS = {
            any_scope_state = {
                owner = root
                is_incorporated = yes
                has_building = building_port
            }
        }
        s:STATE_MINDANAO = {
            any_scope_state = {
                owner = root
                is_incorporated = yes
                has_building = building_port
            }
        }
    }

    on_complete = {
        trigger_event = { id = philippines.10 }
        hidden_effect = {
            set_variable = phi_dev_done
        }
    }

    event_outcome_completed_effect_desc = {
        header = philippines10a_tt
        effect = {
            s:STATE_VISAYAS = {
                add_state_trait = state_trait_port_of_iloilo
            }
            add_loyalists = {
                value = medium_radicals
                pop_type = aristocrats
            }
            add_loyalists = {
                value = medium_radicals
                pop_type = capitalists
            }
            add_modifier = {
                name = modifier_growth_of_the_middle_class
                days = long_modifier_time
            }
            custom_tooltip = {
                text = unlocks_je_philippines_main_ilustrado_button_tt
            }
        }
    }

    event_outcome_completed_effect_desc = {
        header = philippines10b_tt
        effect = {
            s:STATE_MINDANAO = {
                add_state_trait = state_trait_port_of_davao
            }
            add_loyalists = {
                value = medium_radicals
                pop_type = aristocrats
            }
            add_loyalists = {
                value = medium_radicals
                pop_type = capitalists
            }
            add_modifier = {
                name = modifier_growth_of_the_middle_class
                days = long_modifier_time
            }
            custom_tooltip = {
                text = unlocks_je_philippines_main_ilustrado_button_tt
            }
        }
    }

    fail = {
        OR = {
            NOT = { 
                has_state_in_state_region = STATE_LUZON
            }
            NOT = { 
                has_state_in_state_region = STATE_VISAYAS
            }
        }
    }

    on_fail = {
        add_modifier = {
            name = modifier_developmental_dearth
            days = normal_modifier_time
        }
        add_modifier = {
            name = modifier_archipelagic_anger
            days = normal_modifier_time
        }
        if = {
            limit = {
                has_modifier = philippines_development_modifier_a
            }
            remove_modifier = philippines_development_modifier_a
        }
        if = {
            limit = {
                has_modifier = philippines_development_modifier_b
            }
            remove_modifier = philippines_development_modifier_b
        }
    }


    invalid = {
        NOT = {
            c:PHI ?= this
        }
    }

    weight = 1000
    transferable = no
    should_be_pinned_by_default = yes
}


je_philippines_main = {
	icon = "gfx/interface/icons/event_icons/event_scales.dds"

	group = je_group_historical_content

    is_shown_in_lobby = {
        c:PHI ?= this
        has_dlc_feature = ip4_content
    }

    scripted_button = je_philippines_main_ilustrado_button # Ilustrados

    is_shown_when_inactive = {
        has_dlc_feature = ip4_content
        c:PHI ?= this
	}

	possible = {
        c:PHI ?= this
        custom_tooltip = {
            text = spain_is_overlord_tt
            top_overlord = {
                c:SPA ?= this
            }
        }
        has_technology_researched = nationalism
	}

	immediate = {
        trigger_event = { id = philippines.1 days = 0 popup = yes }
        ig:ig_devout = {
            save_scope_as = church_ig
        }
        ig:ig_intelligentsia ?= {
            save_scope_as = intelligentsia_ig
        }
        ig:ig_armed_forces = {
            save_scope_as = armed_forces_ig
        }
	}

    on_yearly_pulse = {
        random_events = {
            10 = 0
            1 = philippines.4
        }
    }

    custom_completion_header = je_philippines_main_header_independence_complete

	complete = {
        is_subject = no
        is_diplomatic_play_committed_participant = no
	}

    on_complete = {
        trigger_event = { id = philippines.2 popup = yes }
        hidden_effect = {
            set_variable = je_philippines_main_complete_happened
        }
    }

    event_outcome_completed_effect_desc = {
        header = philippines.2.a
        effect = {
            add_primary_culture = cu:filipino_mestizo
            remove_primary_culture = cu:spanish
            add_modifier = {
                name = modifier_phi_indepenent_vision
                days = long_modifier_time
            }
            add_modifier = {
                name = modifier_national_consolidation
                days = long_modifier_time
            }
        }
    }

    event_outcome_failed_effect_desc = {
        header = philippines.3.a
        effect = {
            add_primary_culture = cu:filipino_mestizo
            add_modifier = {
                name = modifier_phi_spanish_vision
                days = long_modifier_time
            }
            add_modifier = {
                name = modifier_metropole_business_networks
                days = long_modifier_time
            }
        }
    }

    custom_on_completion_header = je_philippines_main_header_independence_on_complete

    custom_failure_header = je_philippines_main_header_reliance_complete

    fail = {
        custom_tooltip = {
            text = no_insurrectionary_movement_tt
            NOT = {
                any_political_movement = {
                    is_insurrectionary = yes
                }
            }
        }
        AND = {
            OR = {
                is_subject_type = subject_type_dominion
                is_subject_type = subject_type_protectorate
                is_subject_type = subject_type_personal_union
            }
            custom_tooltip = {
                text = spain_is_overlord_tt
                top_overlord = {
                    c:SPA ?= this
                }
            }
            c:SPA ?= {
                relations:root >= relations_threshold:amicable
            }
        }
        legitimacy >= 50
        liberty_desire <= 25
    }

    on_fail = {
        trigger_event = { id = philippines.3 popup = yes }
        hidden_effect = {
            set_variable = je_philippines_main_reliance_happened
        }
    }
    custom_on_failure_header = je_philippines_main_header_on_reliance_complete

	weight = 5000

    should_be_pinned_by_default = yes
}

je_filipino_ethnogenesis = {
    icon = "gfx/interface/icons/event_icons/event_portrait.dds"

    group = je_group_historical_content

    scripted_button = je_filipino_ethnogenesis_colonization_button

    is_shown_in_lobby = {
        c:PHI ?= this
        has_dlc_feature = ip4_content
    }

    is_shown_when_inactive = {
        has_dlc_feature = ip4_content
        c:PHI ?= this
    }

    possible = {
        c:PHI ?= this
        has_technology_researched = nationalism
    }

    immediate = {
    }

    on_yearly_pulse = {
        random_events = {
        }
    }

    custom_completion_header = je_philippines_ethnogenesis_header_independence_complete

    complete = {
        country_has_primary_culture = cu:filipino_mestizo
        is_subject = no
        literacy_rate >= 0.6
        country_average_culture_pop_acceptance = {
            culture = cu:tagalog
            value >= acceptance_status_5
        }
        country_average_culture_pop_acceptance = {
            culture = cu:ilocano
            value >= acceptance_status_5
        }
        country_average_culture_pop_acceptance = {
            culture = cu:visayan
            value >= acceptance_status_5
        }
    }

    on_complete = {
        trigger_event = {
            id = philippines.11
            popup = yes
        }
    }

    custom_on_completion_header = je_philippines_ethnogenesis_header_independence_on_complete

    custom_failure_header = je_philippines_ethnogenesis_header_reliance_complete

    event_outcome_completed_effect_desc = {
        header = philippines.11.a
        effect = {
            add_primary_culture = cu:filipino
            start_national_awakening = {
                culture = cu:filipino
                months = 120
                state_region = s:STATE_LUZON
            }
            custom_tooltip = filipino_assimilation_tooltip
            every_scope_state = {
                limit = {
                    OR = {
                        state_region = s:STATE_LUZON
                        state_region = s:STATE_VISAYAS
                        state_region = s:STATE_MINDANAO
                    }
                }
                add_modifier = {
                    name = modifier_popular_genesis
                    days = long_modifier_time
                }
            }
        }
    }

    event_outcome_failed_effect_desc = {
        header = philippines.12.a
        effect = {
            add_primary_culture = cu:filipino_hispanophone
            start_national_awakening = {
                culture = cu:filipino_hispanophone
                months = 120
                state_region = s:STATE_LUZON
            }
            custom_tooltip = {
                text = filipino_hispanophone_assimilation_tooltip
            }
            every_scope_state = {
                limit = {
                    OR = {
                        state_region = s:STATE_LUZON
                        state_region = s:STATE_VISAYAS
                        state_region = s:STATE_MINDANAO
                    }
                }
                add_modifier = {
                    name = modifier_popular_genesis
                    days = long_modifier_time
                }
            }
            add_modifier = {
                name = modifier_phi_spanish_vision
                days = long_modifier_time
            }
        }
    }

    fail = {
        country_has_primary_culture = cu:filipino_mestizo
        any_overlord_or_above = {
            country_has_primary_culture = cu:spanish
        }
        literacy_rate >= 0.6
        country_average_culture_pop_acceptance = {
            culture = cu:tagalog
            value >= acceptance_status_5
        }
        country_average_culture_pop_acceptance = {
            culture = cu:ilocano
            value >= acceptance_status_5
        }
        country_average_culture_pop_acceptance = {
            culture = cu:visayan
            value >= acceptance_status_5
        }
    }

    on_fail = {
        trigger_event = {
            id = philippines.12
            popup = yes
        }
    }
    custom_on_failure_header = je_philippines_ethnogenesis_header_reliance_on_complete

    weight = 5000

    should_be_pinned_by_default = yes
}
