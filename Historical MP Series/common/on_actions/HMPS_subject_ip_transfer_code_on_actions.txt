###############################################################
#  based on "Treasury to Investment Pool, created by Lord R"  #
###############################################################

on_monthly_pulse_country = {
	on_actions = {
		investment_auto_transfer_on_monthly_effects
	}
}

investment_auto_transfer_on_monthly_effects = {
	effect = {
#		### HMPS cosde to ensure that tags who float large budget surplusses (mostly colonial puppets/ai nations) dont delete money
#		if = {
#			limit = {
#				gold_reserves > 0
#			}
#			set_variable = {
#				name = percentage_gold_reserves_var
#				value = gold_reserves_limit
#			}
#			change_variable = {
#				name = percentage_gold_reserves_var
#				multiply = 1.0
#			}
#			if = {
#				limit = {
#					gold_reserves > var:percentage_gold_reserves_var
#				}
#				set_variable = {
#					name = amount_to_transfer_var
#					value = gold_reserves
#				}
#				change_variable = {
#					name = amount_to_transfer_var
#					subtract = var:percentage_gold_reserves_var
#				}
#				add_investment_pool = var:amount_to_transfer_var
#				change_variable = {
#					name = amount_to_transfer_var
#					multiply = -1
#				}
#				add_treasury = var:amount_to_transfer_var
#			}
#			remove_variable = percentage_gold_reserves_var
#			remove_variable = amount_to_transfer_var
#		}

		### HMPS code to transfer IP of tags who have "The Company" to their overlords IP
		if = {
			limit = {
				has_law = law_type:law_the_company
				is_subject = yes
				investment_pool > 0
			}
			set_global_variable = {
				name = subject_investment_pool
				value = investment_pool
			}
			top_overlord = {
				add_investment_pool = global_var:subject_investment_pool
			}
			change_global_variable  = {
				name = subject_investment_pool
				multiply = -1
			}
			add_investment_pool = global_var:subject_investment_pool
			remove_global_variable  = subject_investment_pool
		}
	}
}