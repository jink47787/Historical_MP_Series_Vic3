je_spain_provisional_government_portuguese_button = {
	name = je_spain_provisional_government_portuguese_button
	desc = je_spain_provisional_government_portuguese_button_desc

	visible = {
		exists = c:POR
		c:POR ?= {
			has_law = law_type:law_monarchy
		}
	}

	possible = {
		"c:POR.relations(ROOT)" >= relations_threshold:cordial
		custom_tooltip = {
			text = not_already_used_this_interaction_tt
			NOT = {
				has_variable = portuguese_king_search_var
			}
		}
		custom_tooltip = {
			text = not_using_other_interaction_tt
			NOT = {
				has_variable = king_searching_var
			}
		}
		custom_tooltip = {
			text = already_couped_dynasty_tt
			NOT = {
				var:spa_couped_dynasty ?= 6
			}
		}
	}

	selected = {
		has_variable = portuguese_king_search_var
	}

	effect = {
		set_variable = king_searching_var
		set_variable = { name = portuguese_king_search_var days = very_long_modifier_time }
		c:POR ?= {
			trigger_event = {
				id = spain_provisional_government.1
				days = 7
			}
		}
		show_as_tooltip = {
			custom_tooltip = TREATY_PROPOSAL_TOOLTIP_IF_ACCEPTED_TITLE
			random_list = {
				2 = {
					custom_tooltip = {
						text = spa_becomes_personal_union_of_por_tt
						create_diplomatic_pact = {
							country = c:SPA
							type = personal_union
						}
					}
				}
				4 = {
					c:SPA ?= {
						country_generate_peripheral_braganza_ruler_display = yes
					}
				}
			}
			ig:ig_petty_bourgeoisie ?= {
				add_modifier = {
					name = modifier_enthroned_preferred_candidate
					days = normal_modifier_time
				}
			}
		}
	}

	ai_chance = {
		value = 1
		if = { # Make the achievement easier
			limit = {
				c:POR ?= {
					is_player = yes
				}
			}
			add = 10000
		}
	}
}

je_spain_provisional_government_espartero_button = {
	name = je_spain_provisional_government_espartero_button
	desc = je_spain_provisional_government_espartero_button_desc

	visible = {
		NOT = {
			has_global_variable = espartero_is_dead_var
		}
	}

	possible = {
		custom_tooltip = {
			text = not_already_used_this_interaction_tt
			NOT = {
				has_variable = espartero_king_search_var
			}
		}
		custom_tooltip = {
			text = not_using_other_interaction_tt
			NOT = {
				has_variable = king_searching_var
			}
		}
		custom_tooltip = {
			text = already_couped_dynasty_tt
			NOT = {
				var:spa_couped_dynasty ?= 4
			}
		}
	}

	selected = {
		has_variable = espartero_king_search_var
	}

	effect = {
		set_variable = king_searching_var
		set_variable = { name = espartero_king_search_var days = very_long_modifier_time }
		custom_tooltip = modified_by_espartero_age_tt
		random_list = {
			25 = {
				remove_variable = king_searching_var
				custom_tooltip = espartero_refuses_kingship_tt
				post_notification = no_espartero_available
			}
			100 = {
				modifier = {
					subtract = espartero_age
				}
				trigger_event = {
					id = spain_provisional_government.2
					days = 1
				}
				ig:ig_petty_bourgeoisie ?= {
					add_modifier = {
						name = modifier_enthroned_preferred_candidate
						days = normal_modifier_time
					}
				}
			}
		}
	}

	ai_chance = {
		value = 1
	}
}

je_spain_provisional_government_hohenzollern_button = {
	name = je_spain_provisional_government_hohenzollern_button
	desc = je_spain_provisional_government_hohenzollern_button_desc

	visible = {
		OR = {
			AND = {
				exists = c:PRU
				c:PRU ?= {
					has_law = law_type:law_monarchy
					any_subject_or_below = {
						any_scope_state = {
							this = p:x908060.state
						}
					}
				}
			}
			AND = {
				exists = c:GER
				c:GER ?= {
					has_law = law_type:law_monarchy
					any_subject_or_below = {
						any_scope_state = {
							this = p:x908060.state
						}
					}
				}
			}
			AND = {
				exists = c:HOH
				c:HOH ?= {
					has_law = law_type:law_monarchy
					any_scope_state = {
						this = p:x908060.state
					}
				}
			}
		}
	}

	possible = {
		trigger_if = {
			limit = {
				exists = c:PRU
				c:PRU ?= {
					any_subject_or_below = {
						any_scope_state = {
							this = p:x908060.state
						}
					}
				}
			}
			"c:PRU.relations(ROOT)" >= relations_threshold:cordial
		}
		trigger_else_if = {
			limit = {
				exists = c:GER
				c:GER ?= {
					any_subject_or_below = {
						any_scope_state = {
							this = p:x908060.state
						}
					}
				}
			}
			"c:GER.relations(ROOT)" >= relations_threshold:cordial
		}
		trigger_else_if = {
			limit = {
				exists = c:HOH
				c:HOH ?= {
					any_scope_state = {
						this = p:x908060.state
					}
				}
			}
			"c:HOH.relations(ROOT)" >= relations_threshold:cordial
		}
		custom_tooltip = {
			text = not_already_used_this_interaction_tt
			NOT = {
				has_variable = hohenzollern_king_search_var
			}
		}
		custom_tooltip = {
			text = not_using_other_interaction_tt
			NOT = {
				has_variable = king_searching_var
			}
		}
		custom_tooltip = {
			text = already_couped_dynasty_tt
			NOT = {
				var:spa_couped_dynasty ?= 2
			}
		}
	}

	selected = {
		has_variable = hohenzollern_king_search_var
	}

	effect = {
		set_variable = king_searching_var
		ROOT = {
			save_scope_as = spain_scope
		}
		set_variable = { name = hohenzollern_king_search_var days = very_long_modifier_time }
		if = {
			limit = {
				exists = c:FRA
			}
			c:FRA ?= {
				save_scope_as = france_scope
			}
		}
		if = {
			limit = {
				exists = c:PRU
				c:PRU ?= {
					any_subject_or_below = {
						any_scope_state = {
							this = p:x908060.state
						}
					}
				}
			}
			c:PRU ?= {
				trigger_event = { id = spain_provisional_government.3 days = 7 }
			}
		}
		else_if = {
			limit = {
				exists = c:GER
				c:GER ?= {
					any_subject_or_below = {
						any_scope_state = {
							this = p:x908060.state
						}
					}
				}
			}
			c:GER ?= {
				trigger_event = { id = spain_provisional_government.3 days = 7 }
			}
		}
		else_if = {
			limit = {
				exists = c:HOH
				c:HOH ?= {
					any_scope_state = {
						this = p:x908060.state
					}
				}
			}
			c:HOH ?= {
				trigger_event = { id = spain_provisional_government.3 days = 7 }
			}
		}
		show_as_tooltip = {
			custom_tooltip = TREATY_PROPOSAL_TOOLTIP_IF_ACCEPTED_TITLE
			custom_tooltip = will_cause_diplomatic_issues_with_france_tt
			if = {
				limit = {
					OR = {
						c:HOH ?= {
							any_scope_character = {
								has_template = HOH_leopold_von_hohenzollern
							}
						}
						c:PRU ?= {
							any_scope_character = {
								has_template = HOH_leopold_von_hohenzollern
							}
						}
						c:GER ?= {
							any_scope_character = {
								has_template = HOH_leopold_von_hohenzollern
							}
						}
					}
				}
				custom_tooltip = leopold_von_hohenzollern_tt
			}
			else = {
				custom_tooltip = guillermo_von_hohenzollern_tt
			}
			ig:ig_armed_forces ?= {
				add_modifier = {
					name = modifier_enthroned_preferred_candidate
					days = normal_modifier_time
				}
			}
		}
	}

	ai_chance = {
		value = 1
	}
}

je_spain_provisional_government_italian_button = {
	name = je_spain_provisional_government_italian_button
	desc = je_spain_provisional_government_italian_button_desc

	visible = {
		OR = {
			AND = {
				exists = c:SAR
				c:SAR ?= {
					has_law = law_type:law_monarchy
				}
			}
			AND = {
				exists = c:ITA
				c:ITA ?= {
					has_law = law_type:law_monarchy
					was_formed_from = SAR
				}
			}
		}
	}

	possible = {
		trigger_if = {
			limit = {
				exists = c:SAR
			}
			"c:SAR.relations(ROOT)" >= relations_threshold:cordial
		}
		trigger_else_if = {
			limit = {
				exists = c:ITA
			}
			"c:ITA.relations(ROOT)" >= relations_threshold:cordial
		}
		custom_tooltip = {
			text = not_already_used_this_interaction_tt
			NOT = {
				has_variable = italian_king_search_var
			}
		}
		custom_tooltip = {
			text = not_using_other_interaction_tt
			NOT = {
				has_variable = king_searching_var
			}
		}
		custom_tooltip = {
			text = already_couped_dynasty_tt
			NOT = {
				var:spa_couped_dynasty ?= 3
			}
		}
	}

	selected = {
		has_variable = italian_king_search_var
	}

	effect = {
		set_variable = king_searching_var
		set_variable = { name = italian_king_search_var days = very_long_modifier_time }
		if = {
			limit = {
				exists = c:SAR
			}
			c:SAR ?= {
				trigger_event = { id = spain_provisional_government.4 days = 7 }
			}
		}
		else_if = {
			limit = {
				exists = c:ITA
				c:ITA ?= {
					was_formed_from = SAR
				}
			}
			c:ITA ?= {
				trigger_event = { id = spain_provisional_government.4 days = 7 }
			}
		}
		show_as_tooltip = {
			custom_tooltip = TREATY_PROPOSAL_TOOLTIP_IF_ACCEPTED_TITLE
			if = {
				limit = {
					game_date > 1863.1.1
					game_date < 1890.1.1
				}
				custom_tooltip = amadeo_de_savoy_tt
			}
			else = {
				custom_tooltip = victor_de_savoy_tt
			}
			ig:ig_intelligentsia ?= {
				add_modifier = {
					name = modifier_enthroned_preferred_candidate
					days = normal_modifier_time
				}
			}
		}
	}

	ai_chance = {
		value = 1
	}
}

je_spain_provisional_government_isabelist_button = {
	name = je_spain_provisional_government_isabelist_button
	desc = je_spain_provisional_government_isabelist_button_desc

	visible = {
		always = yes
	}

	possible = {
		custom_tooltip = {
			text = not_already_used_this_interaction_tt
			NOT = {
				has_variable = isabelist_king_search_var
			}
		}
		custom_tooltip = {
			text = not_using_other_interaction_tt
			NOT = {
				has_variable = king_searching_var
			}
		}
	}

	selected = {
		has_variable = isabelist_king_search_var
	}

	effect = {
		set_variable = king_searching_var
		set_variable = { name = isabelist_king_search_var days = very_long_modifier_time }
		trigger_event = { id = spain_provisional_government.5 }
		show_as_tooltip = {
			if = {
				limit = {
					any_character_in_void = {
						has_variable = deposed_spanish_heir
					}
				}
				random_character_in_void = {
					limit = {
						has_variable = deposed_spanish_heir
					}
					hidden_effect = {
						free_character_from_void = yes
					}
					set_character_as_ruler = yes
				}
			}
			else = {
				country_generate_constitutional_spain_ruler = yes
			}
			add_radicals = {
				value = medium_radicals
			}
		}
	}

	ai_chance = {
		value = 1
	}
}

je_spain_provisional_government_carlist_button = {
	name = je_spain_provisional_government_carlist_button
	desc = je_spain_provisional_government_carlist_button_desc

	visible = {
		always = yes
	}

	possible = {
		OR = {
			ruler ?= {
				character_has_carlist_ideology = yes
			}
			any_interest_group = {
				is_in_government = yes
				leader = {
					character_has_carlist_ideology = yes
				}
			}
		}
		custom_tooltip = {
			text = not_already_used_this_interaction_tt
			NOT = {
				has_variable = carlist_king_search_var
			}
		}
		custom_tooltip = {
			text = not_using_other_interaction_tt
			NOT = {
				has_variable = king_searching_var
			}
		}
	}

	selected = {
		has_variable = carlist_king_search_var
	}

	effect = {
		set_variable = king_searching_var
		set_variable = { name = carlist_king_search_var days = very_long_modifier_time }
		trigger_event = { id = spain_provisional_government.6 }
		show_as_tooltip = {
			country_generate_carlist_spain_ruler = yes
			ig:ig_landowners ?= {
				add_modifier = {
					name = modifier_enthroned_preferred_candidate
					days = normal_modifier_time
				}
			}
		}
	}

	ai_chance = {
		value = 1
	}
}

je_spain_provisional_government_bonaparte_button = {
	name = je_spain_provisional_government_bonaparte_button
	desc = je_spain_provisional_government_bonaparte_button_desc

	visible = {
		AND = {
			exists = c:FRA
			c:FRA.ruler ?= {
				has_ideology = ideology:ideology_bonapartist
			}
		}
		ig:ig_armed_forces ?= {
			is_in_government = yes
		}
	}

	possible = {
		"c:FRA.relations(ROOT)" >= relations_threshold:friendly
		ig:ig_armed_forces ?= {
			is_in_government = yes
		}
		custom_tooltip = {
			text = not_already_used_this_interaction_tt
			NOT = {
				has_variable = bonaparte_king_search_var
			}
		}
		custom_tooltip = {
			text = not_using_other_interaction_tt
			NOT = {
				has_variable = king_searching_var
			}
		}
		custom_tooltip = {
			text = already_couped_dynasty_tt
			NOT = {
				var:spa_couped_dynasty ?= 5
			}
		}
	}

	selected = {
		has_variable = bonaparte_king_search_var
	}

	effect = {
		set_variable = king_searching_var
		set_variable = { name = bonaparte_king_search_var days = very_long_modifier_time }
		c:FRA ?= {
			trigger_event = { id = spain_provisional_government.7 days = 7 }
		}
		show_as_tooltip = {
			custom_tooltip = TREATY_PROPOSAL_TOOLTIP_IF_ACCEPTED_TITLE
			custom_tooltip = napoleon_bonaparte_tt
			add_radicals = {
				value = large_radicals
			}
		}
	}

	ai_chance = {
		value = 1
	}
}

je_spain_provisional_government_republic_button = {
	name = je_spain_provisional_government_republic_button
	desc = je_spain_provisional_government_republic_button_desc

	visible = {
		always = yes
	}

	possible = {
		OR = {
			any_interest_group = {
				is_in_government = yes
				law_enactment_stance = {
					law = law_type:law_republic
					value >= approve
				}
			}
			custom_tooltip = {
				text = je_active_for_more_than_five_years_tt
				scope:journal_entry.journal_entry_age > 1825
			}
		}
		custom_tooltip = {
			text = not_already_used_this_interaction_tt
			NOT = {
				has_variable = republic_king_search_var
			}
		}
		custom_tooltip = {
			text = not_using_other_interaction_tt
			NOT = {
				has_variable = king_searching_var
			}
		}
	}

	selected = {
		has_variable = republic_king_search_var
	}

	effect = {
		set_variable = king_searching_var
		set_variable = { name = republic_king_search_var days = 90 }
		trigger_event = {
			id = spain_provisional_government.8
		}
		show_as_tooltip = {
			activate_law = law_type:law_republic
			every_interest_group = {
				limit = {
					law_stance = {
						law = law_type:law_republic
						value < neutral
					}
				}
				add_modifier = {
					name = modifier_declared_republic_negative
					days = normal_modifier_time
					is_decaying = yes
				}
			}
			every_interest_group = {
				limit = {
					law_stance = {
						law = law_type:law_republic
						value > neutral
					}
				}
				add_modifier = {
					name = modifier_declared_republic_positive
					days = normal_modifier_time
					is_decaying = yes
				}
			}
		}
	}

	ai_chance = {
		value = 1
	}
}
