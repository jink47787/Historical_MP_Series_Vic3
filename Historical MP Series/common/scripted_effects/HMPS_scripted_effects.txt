assign_opium_addiction_penalty = { #Paradox does not allow for variables to be used when setting the duration of modifiers, so this is what we must do :(
	if = { limit = { year <= 1836 } add_modifier = { name = chinese_opium_addiction years = 60 is_decaying = yes multiplier = 1.000 } }
	else_if = { limit = { year <= 1837 } add_modifier = { name = chinese_opium_addiction years = 59 is_decaying = yes multiplier = 0.983 } }
	else_if = { limit = { year <= 1838 } add_modifier = { name = chinese_opium_addiction years = 58 is_decaying = yes multiplier = 0.967 } }
	else_if = { limit = { year <= 1839 } add_modifier = { name = chinese_opium_addiction years = 57 is_decaying = yes multiplier = 0.950 } }
	else_if = { limit = { year <= 1840 } add_modifier = { name = chinese_opium_addiction years = 56 is_decaying = yes multiplier = 0.933 } }
	else_if = { limit = { year <= 1841 } add_modifier = { name = chinese_opium_addiction years = 55 is_decaying = yes multiplier = 0.917 } }
	else_if = { limit = { year <= 1842 } add_modifier = { name = chinese_opium_addiction years = 54 is_decaying = yes multiplier = 0.900 } }
	else_if = { limit = { year <= 1843 } add_modifier = { name = chinese_opium_addiction years = 53 is_decaying = yes multiplier = 0.883 } }
	else_if = { limit = { year <= 1844 } add_modifier = { name = chinese_opium_addiction years = 52 is_decaying = yes multiplier = 0.867 } }
	else_if = { limit = { year <= 1845 } add_modifier = { name = chinese_opium_addiction years = 51 is_decaying = yes multiplier = 0.850 } }
	else_if = { limit = { year <= 1846 } add_modifier = { name = chinese_opium_addiction years = 50 is_decaying = yes multiplier = 0.833 } }
	else_if = { limit = { year <= 1847 } add_modifier = { name = chinese_opium_addiction years = 49 is_decaying = yes multiplier = 0.817 } }
	else_if = { limit = { year <= 1848 } add_modifier = { name = chinese_opium_addiction years = 48 is_decaying = yes multiplier = 0.800 } }
	else_if = { limit = { year <= 1849 } add_modifier = { name = chinese_opium_addiction years = 47 is_decaying = yes multiplier = 0.783 } }
	else_if = { limit = { year <= 1850 } add_modifier = { name = chinese_opium_addiction years = 46 is_decaying = yes multiplier = 0.767 } }
	else_if = { limit = { year <= 1851 } add_modifier = { name = chinese_opium_addiction years = 45 is_decaying = yes multiplier = 0.750 } }
	else_if = { limit = { year <= 1852 } add_modifier = { name = chinese_opium_addiction years = 44 is_decaying = yes multiplier = 0.733 } }
	else_if = { limit = { year <= 1853 } add_modifier = { name = chinese_opium_addiction years = 43 is_decaying = yes multiplier = 0.717 } }
	else_if = { limit = { year <= 1854 } add_modifier = { name = chinese_opium_addiction years = 42 is_decaying = yes multiplier = 0.700 } }
	else_if = { limit = { year <= 1855 } add_modifier = { name = chinese_opium_addiction years = 41 is_decaying = yes multiplier = 0.683 } }
	else_if = { limit = { year <= 1856 } add_modifier = { name = chinese_opium_addiction years = 40 is_decaying = yes multiplier = 0.667 } }
	else_if = { limit = { year <= 1857 } add_modifier = { name = chinese_opium_addiction years = 39 is_decaying = yes multiplier = 0.650 } }
	else_if = { limit = { year <= 1858 } add_modifier = { name = chinese_opium_addiction years = 38 is_decaying = yes multiplier = 0.633 } }
	else_if = { limit = { year <= 1859 } add_modifier = { name = chinese_opium_addiction years = 37 is_decaying = yes multiplier = 0.617 } }
	else_if = { limit = { year <= 1860 } add_modifier = { name = chinese_opium_addiction years = 36 is_decaying = yes multiplier = 0.600 } }
	else_if = { limit = { year <= 1861 } add_modifier = { name = chinese_opium_addiction years = 35 is_decaying = yes multiplier = 0.583 } }
	else_if = { limit = { year <= 1862 } add_modifier = { name = chinese_opium_addiction years = 34 is_decaying = yes multiplier = 0.567 } }
	else_if = { limit = { year <= 1863 } add_modifier = { name = chinese_opium_addiction years = 33 is_decaying = yes multiplier = 0.550 } }
	else_if = { limit = { year <= 1864 } add_modifier = { name = chinese_opium_addiction years = 32 is_decaying = yes multiplier = 0.533 } }
	else_if = { limit = { year <= 1865 } add_modifier = { name = chinese_opium_addiction years = 31 is_decaying = yes multiplier = 0.517 } }
	else_if = { limit = { year <= 1866 } add_modifier = { name = chinese_opium_addiction years = 30 is_decaying = yes multiplier = 0.500 } }
	else_if = { limit = { year <= 1867 } add_modifier = { name = chinese_opium_addiction years = 29 is_decaying = yes multiplier = 0.483 } }
	else_if = { limit = { year <= 1868 } add_modifier = { name = chinese_opium_addiction years = 28 is_decaying = yes multiplier = 0.467 } }
	else_if = { limit = { year <= 1869 } add_modifier = { name = chinese_opium_addiction years = 27 is_decaying = yes multiplier = 0.450 } }
	else_if = { limit = { year <= 1870 } add_modifier = { name = chinese_opium_addiction years = 26 is_decaying = yes multiplier = 0.433 } }
	else_if = { limit = { year <= 1871 } add_modifier = { name = chinese_opium_addiction years = 25 is_decaying = yes multiplier = 0.417 } }
	else_if = { limit = { year <= 1872 } add_modifier = { name = chinese_opium_addiction years = 24 is_decaying = yes multiplier = 0.400 } }
	else_if = { limit = { year <= 1873 } add_modifier = { name = chinese_opium_addiction years = 23 is_decaying = yes multiplier = 0.383 } }
	else_if = { limit = { year <= 1874 } add_modifier = { name = chinese_opium_addiction years = 22 is_decaying = yes multiplier = 0.367 } }
	else_if = { limit = { year <= 1875 } add_modifier = { name = chinese_opium_addiction years = 21 is_decaying = yes multiplier = 0.350 } }
	else_if = { limit = { year <= 1876 } add_modifier = { name = chinese_opium_addiction years = 20 is_decaying = yes multiplier = 0.333 } }
	else_if = { limit = { year <= 1877 } add_modifier = { name = chinese_opium_addiction years = 19 is_decaying = yes multiplier = 0.317 } }
	else_if = { limit = { year <= 1878 } add_modifier = { name = chinese_opium_addiction years = 18 is_decaying = yes multiplier = 0.300 } }
	else_if = { limit = { year <= 1879 } add_modifier = { name = chinese_opium_addiction years = 17 is_decaying = yes multiplier = 0.283 } }
	else_if = { limit = { year <= 1880 } add_modifier = { name = chinese_opium_addiction years = 16 is_decaying = yes multiplier = 0.267 } }
	else_if = { limit = { year <= 1881 } add_modifier = { name = chinese_opium_addiction years = 15 is_decaying = yes multiplier = 0.250 } }
	else_if = { limit = { year <= 1882 } add_modifier = { name = chinese_opium_addiction years = 14 is_decaying = yes multiplier = 0.233 } }
	else_if = { limit = { year <= 1883 } add_modifier = { name = chinese_opium_addiction years = 13 is_decaying = yes multiplier = 0.217 } }
	else_if = { limit = { year <= 1884 } add_modifier = { name = chinese_opium_addiction years = 12 is_decaying = yes multiplier = 0.200 } }
	else_if = { limit = { year <= 1885 } add_modifier = { name = chinese_opium_addiction years = 11 is_decaying = yes multiplier = 0.183 } }
	else_if = { limit = { year <= 1886 } add_modifier = { name = chinese_opium_addiction years = 10 is_decaying = yes multiplier = 0.167 } }
	else_if = { limit = { year <= 1887 } add_modifier = { name = chinese_opium_addiction years = 9 is_decaying = yes multiplier = 0.150 } }
	else_if = { limit = { year <= 1888 } add_modifier = { name = chinese_opium_addiction years = 8 is_decaying = yes multiplier = 0.133 } }
	else_if = { limit = { year <= 1889 } add_modifier = { name = chinese_opium_addiction years = 7 is_decaying = yes multiplier = 0.117 } }
	else_if = { limit = { year <= 1890 } add_modifier = { name = chinese_opium_addiction years = 6 is_decaying = yes multiplier = 0.100 } }
	else_if = { limit = { year <= 1891 } add_modifier = { name = chinese_opium_addiction years = 5 is_decaying = yes multiplier = 0.083 } }
	else_if = { limit = { year <= 1892 } add_modifier = { name = chinese_opium_addiction years = 4 is_decaying = yes multiplier = 0.067 } }
	else_if = { limit = { year <= 1893 } add_modifier = { name = chinese_opium_addiction years = 3 is_decaying = yes multiplier = 0.050 } }
	else_if = { limit = { year <= 1894 } add_modifier = { name = chinese_opium_addiction years = 2 is_decaying = yes multiplier = 0.033 } }
	else_if = { limit = { year <= 1895 } add_modifier = { name = chinese_opium_addiction years = 1 is_decaying = yes multiplier = 0.017 } }
}

assign_early_warlords_penalty = { # Paradox does not allow for variables to be used when setting the duration of modifiers, so this is what we must do :(
	if = { limit = { year <= 1836 } add_modifier = { name = early_warlords_collapse years = 80 is_decaying = yes multiplier = 80 } }
	else_if = { limit = { year <= 1837 } add_modifier = { name = early_warlords_collapse years = 79 is_decaying = yes multiplier = 79 } }
	else_if = { limit = { year <= 1838 } add_modifier = { name = early_warlords_collapse years = 78 is_decaying = yes multiplier = 78 } }
	else_if = { limit = { year <= 1839 } add_modifier = { name = early_warlords_collapse years = 77 is_decaying = yes multiplier = 77 } }
	else_if = { limit = { year <= 1840 } add_modifier = { name = early_warlords_collapse years = 76 is_decaying = yes multiplier = 76 } }
	else_if = { limit = { year <= 1841 } add_modifier = { name = early_warlords_collapse years = 75 is_decaying = yes multiplier = 75 } }
	else_if = { limit = { year <= 1842 } add_modifier = { name = early_warlords_collapse years = 74 is_decaying = yes multiplier = 74 } }
	else_if = { limit = { year <= 1843 } add_modifier = { name = early_warlords_collapse years = 73 is_decaying = yes multiplier = 73 } }
	else_if = { limit = { year <= 1844 } add_modifier = { name = early_warlords_collapse years = 72 is_decaying = yes multiplier = 72 } }
	else_if = { limit = { year <= 1845 } add_modifier = { name = early_warlords_collapse years = 71 is_decaying = yes multiplier = 71 } }
	else_if = { limit = { year <= 1846 } add_modifier = { name = early_warlords_collapse years = 70 is_decaying = yes multiplier = 70 } }
	else_if = { limit = { year <= 1847 } add_modifier = { name = early_warlords_collapse years = 69 is_decaying = yes multiplier = 69 } }
	else_if = { limit = { year <= 1848 } add_modifier = { name = early_warlords_collapse years = 68 is_decaying = yes multiplier = 68 } }
	else_if = { limit = { year <= 1849 } add_modifier = { name = early_warlords_collapse years = 67 is_decaying = yes multiplier = 67 } }
	else_if = { limit = { year <= 1850 } add_modifier = { name = early_warlords_collapse years = 66 is_decaying = yes multiplier = 66 } }
	else_if = { limit = { year <= 1851 } add_modifier = { name = early_warlords_collapse years = 65 is_decaying = yes multiplier = 65 } }
	else_if = { limit = { year <= 1852 } add_modifier = { name = early_warlords_collapse years = 64 is_decaying = yes multiplier = 64 } }
	else_if = { limit = { year <= 1853 } add_modifier = { name = early_warlords_collapse years = 63 is_decaying = yes multiplier = 63 } }
	else_if = { limit = { year <= 1854 } add_modifier = { name = early_warlords_collapse years = 62 is_decaying = yes multiplier = 62 } }
	else_if = { limit = { year <= 1855 } add_modifier = { name = early_warlords_collapse years = 61 is_decaying = yes multiplier = 61 } }
	else_if = { limit = { year <= 1856 } add_modifier = { name = early_warlords_collapse years = 60 is_decaying = yes multiplier = 60 } }
	else_if = { limit = { year <= 1857 } add_modifier = { name = early_warlords_collapse years = 59 is_decaying = yes multiplier = 59 } }
	else_if = { limit = { year <= 1858 } add_modifier = { name = early_warlords_collapse years = 58 is_decaying = yes multiplier = 58 } }
	else_if = { limit = { year <= 1859 } add_modifier = { name = early_warlords_collapse years = 57 is_decaying = yes multiplier = 57 } }
	else_if = { limit = { year <= 1860 } add_modifier = { name = early_warlords_collapse years = 56 is_decaying = yes multiplier = 56 } }
	else_if = { limit = { year <= 1861 } add_modifier = { name = early_warlords_collapse years = 55 is_decaying = yes multiplier = 55 } }
	else_if = { limit = { year <= 1862 } add_modifier = { name = early_warlords_collapse years = 54 is_decaying = yes multiplier = 54 } }
	else_if = { limit = { year <= 1863 } add_modifier = { name = early_warlords_collapse years = 53 is_decaying = yes multiplier = 53 } }
	else_if = { limit = { year <= 1864 } add_modifier = { name = early_warlords_collapse years = 52 is_decaying = yes multiplier = 52 } }
	else_if = { limit = { year <= 1865 } add_modifier = { name = early_warlords_collapse years = 51 is_decaying = yes multiplier = 51 } }
	else_if = { limit = { year <= 1866 } add_modifier = { name = early_warlords_collapse years = 50 is_decaying = yes multiplier = 50 } }
	else_if = { limit = { year <= 1867 } add_modifier = { name = early_warlords_collapse years = 49 is_decaying = yes multiplier = 49 } }
	else_if = { limit = { year <= 1868 } add_modifier = { name = early_warlords_collapse years = 48 is_decaying = yes multiplier = 48 } }
	else_if = { limit = { year <= 1869 } add_modifier = { name = early_warlords_collapse years = 47 is_decaying = yes multiplier = 47 } }
	else_if = { limit = { year <= 1870 } add_modifier = { name = early_warlords_collapse years = 46 is_decaying = yes multiplier = 46 } }
	else_if = { limit = { year <= 1871 } add_modifier = { name = early_warlords_collapse years = 45 is_decaying = yes multiplier = 45 } }
	else_if = { limit = { year <= 1872 } add_modifier = { name = early_warlords_collapse years = 44 is_decaying = yes multiplier = 44 } }
	else_if = { limit = { year <= 1873 } add_modifier = { name = early_warlords_collapse years = 43 is_decaying = yes multiplier = 43 } }
	else_if = { limit = { year <= 1874 } add_modifier = { name = early_warlords_collapse years = 42 is_decaying = yes multiplier = 42 } }
	else_if = { limit = { year <= 1875 } add_modifier = { name = early_warlords_collapse years = 41 is_decaying = yes multiplier = 41 } }
	else_if = { limit = { year <= 1876 } add_modifier = { name = early_warlords_collapse years = 40 is_decaying = yes multiplier = 40 } }
	else_if = { limit = { year <= 1877 } add_modifier = { name = early_warlords_collapse years = 39 is_decaying = yes multiplier = 39 } }
	else_if = { limit = { year <= 1878 } add_modifier = { name = early_warlords_collapse years = 38 is_decaying = yes multiplier = 38 } }
	else_if = { limit = { year <= 1879 } add_modifier = { name = early_warlords_collapse years = 37 is_decaying = yes multiplier = 37 } }
	else_if = { limit = { year <= 1880 } add_modifier = { name = early_warlords_collapse years = 36 is_decaying = yes multiplier = 36 } }
	else_if = { limit = { year <= 1881 } add_modifier = { name = early_warlords_collapse years = 35 is_decaying = yes multiplier = 35 } }
	else_if = { limit = { year <= 1882 } add_modifier = { name = early_warlords_collapse years = 34 is_decaying = yes multiplier = 34 } }
	else_if = { limit = { year <= 1883 } add_modifier = { name = early_warlords_collapse years = 33 is_decaying = yes multiplier = 33 } }
	else_if = { limit = { year <= 1884 } add_modifier = { name = early_warlords_collapse years = 32 is_decaying = yes multiplier = 32 } }
	else_if = { limit = { year <= 1885 } add_modifier = { name = early_warlords_collapse years = 31 is_decaying = yes multiplier = 31 } }
	else_if = { limit = { year <= 1886 } add_modifier = { name = early_warlords_collapse years = 30 is_decaying = yes multiplier = 30 } }
	else_if = { limit = { year <= 1887 } add_modifier = { name = early_warlords_collapse years = 29 is_decaying = yes multiplier = 29 } }
	else_if = { limit = { year <= 1888 } add_modifier = { name = early_warlords_collapse years = 28 is_decaying = yes multiplier = 28 } }
	else_if = { limit = { year <= 1889 } add_modifier = { name = early_warlords_collapse years = 27 is_decaying = yes multiplier = 27 } }
	else_if = { limit = { year <= 1890 } add_modifier = { name = early_warlords_collapse years = 26 is_decaying = yes multiplier = 26 } }
	else_if = { limit = { year <= 1891 } add_modifier = { name = early_warlords_collapse years = 25 is_decaying = yes multiplier = 25 } }
	else_if = { limit = { year <= 1892 } add_modifier = { name = early_warlords_collapse years = 24 is_decaying = yes multiplier = 24 } }
	else_if = { limit = { year <= 1893 } add_modifier = { name = early_warlords_collapse years = 23 is_decaying = yes multiplier = 23 } }
	else_if = { limit = { year <= 1894 } add_modifier = { name = early_warlords_collapse years = 22 is_decaying = yes multiplier = 22 } }
	else_if = { limit = { year <= 1895 } add_modifier = { name = early_warlords_collapse years = 21 is_decaying = yes multiplier = 21 } }
	else_if = { limit = { year <= 1896 } add_modifier = { name = early_warlords_collapse years = 20 is_decaying = yes multiplier = 20 } }
	else_if = { limit = { year <= 1897 } add_modifier = { name = early_warlords_collapse years = 19 is_decaying = yes multiplier = 19 } }
	else_if = { limit = { year <= 1898 } add_modifier = { name = early_warlords_collapse years = 18 is_decaying = yes multiplier = 18 } }
	else_if = { limit = { year <= 1899 } add_modifier = { name = early_warlords_collapse years = 17 is_decaying = yes multiplier = 17 } }
	else_if = { limit = { year <= 1900 } add_modifier = { name = early_warlords_collapse years = 16 is_decaying = yes multiplier = 16 } }
	else_if = { limit = { year <= 1901 } add_modifier = { name = early_warlords_collapse years = 15 is_decaying = yes multiplier = 15 } }
	else_if = { limit = { year <= 1902 } add_modifier = { name = early_warlords_collapse years = 14 is_decaying = yes multiplier = 14 } }
	else_if = { limit = { year <= 1903 } add_modifier = { name = early_warlords_collapse years = 13 is_decaying = yes multiplier = 13 } }
	else_if = { limit = { year <= 1904 } add_modifier = { name = early_warlords_collapse years = 12 is_decaying = yes multiplier = 12 } }
	else_if = { limit = { year <= 1905 } add_modifier = { name = early_warlords_collapse years = 11 is_decaying = yes multiplier = 11 } }
	else_if = { limit = { year <= 1906 } add_modifier = { name = early_warlords_collapse years = 10 is_decaying = yes multiplier = 10 } }
	else_if = { limit = { year <= 1907 } add_modifier = { name = early_warlords_collapse years = 9 is_decaying = yes multiplier = 9 } }
	else_if = { limit = { year <= 1908 } add_modifier = { name = early_warlords_collapse years = 8 is_decaying = yes multiplier = 8 } }
	else_if = { limit = { year <= 1909 } add_modifier = { name = early_warlords_collapse years = 7 is_decaying = yes multiplier = 7 } }
	else_if = { limit = { year <= 1910 } add_modifier = { name = early_warlords_collapse years = 6 is_decaying = yes multiplier = 6 } }
	else_if = { limit = { year <= 1911 } add_modifier = { name = early_warlords_collapse years = 5 is_decaying = yes multiplier = 5 } }
	else_if = { limit = { year <= 1912 } add_modifier = { name = early_warlords_collapse years = 4 is_decaying = yes multiplier = 4 } }
	else_if = { limit = { year <= 1913 } add_modifier = { name = early_warlords_collapse years = 3 is_decaying = yes multiplier = 3 } }
	else_if = { limit = { year <= 1914 } add_modifier = { name = early_warlords_collapse years = 2 is_decaying = yes multiplier = 2 } }
	else_if = { limit = { year <= 1915 } add_modifier = { name = early_warlords_collapse years = 1 is_decaying = yes multiplier = 1 } }
}

force_single_market = {
	if = {
		limit = {
			is_subject = yes
			overlord = {
				market = prev.market
				NOT = {
					has_diplomatic_pact = {
						who = prev
						type = grant_own_market
					}
				}
			}
		}
		overlord = {
			create_diplomatic_pact = {
				country = prev
				type = grant_own_market
			}
		}
	}
}

calculate_tpg_reconstruction_law_progress = {
	# From Laws
	set_variable = { name = tpg_reconstruction_from_laws value = 0 }
	# Cops
	set_variable = { name = temp_policing_var_contribution value = institution:institution_police.investment }
	if = {
		limit = {
			has_law = law_type:law_no_police
		}
		change_variable = { name = temp_policing_var_contribution add = 0 }
	}
	else_if = {
		limit = {
			has_law = law_type:law_local_police
		}
		change_variable = { name = temp_policing_var_contribution multiply = 0.1 }
	}
	else_if = {
		limit = {
			has_law = law_type:law_dedicated_police
		}
		change_variable = { name = temp_policing_var_contribution multiply = 0.2 }
	}
	else_if = {
		limit = {
			has_law = law_type:law_militarized_police
		}
		change_variable = { name = temp_policing_var_contribution multiply = 0.3 }
	}
	
	# Internal Affairs
	set_variable = { name = temp_ha_var_contribution value = institution:institution_home_affairs.investment }
	if = {
		limit = {
			has_law = law_type:law_no_home_affairs
		}
		change_variable = { name = temp_ha_var_contribution add = 0 }
	}
	else_if = {
		limit = {
			has_law = law_type:law_guaranteed_liberties
		}
		change_variable = { name = temp_ha_var_contribution multiply = 0.1 }
	}
	else_if = {
		limit = {
			has_law = law_type:law_national_guard
		}
		change_variable = { name = temp_ha_var_contribution multiply = 0.2 }
	}
	else_if = {
		limit = {
			has_law = law_type:law_secret_police
		}
		change_variable = { name = temp_ha_var_contribution multiply = 0.3 }
	}
	change_variable = { name = tpg_reconstruction_from_laws add = var:temp_policing_var_contribution }
	change_variable = { name = tpg_reconstruction_from_laws add = var:temp_ha_var_contribution }
	remove_variable = temp_policing_var_contribution
	remove_variable = temp_ha_var_contribution
}